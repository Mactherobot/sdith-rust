pub(crate) mod input;
mod sign;
pub(crate) mod signature;
mod verify;

#[cfg(test)]
mod signing_and_verifying_tests {

    use nist_pqc_seeded_rng::{NistPqcAes256CtrRng, RngCore, SeedableRng};

    use super::signature::Signature;
    use crate::{
        constants::{
            params::{PARAM_SALT_SIZE, PARAM_SEED_SIZE},
            types::Seed,
        },
        keygen,
    };

    #[test]
    fn test_sign_verify_signature() {
        let spec_master_seed: Seed = [
            124u8, 153, 53, 160, 176, 118, 148, 170, 12, 109, 16, 228, 219, 107, 26, 221,
        ];
        let (pk, sk) = crate::keygen::keygen(spec_master_seed);
        let message = b"Hello, World!";
        let entropy = (spec_master_seed, [0u8; PARAM_SALT_SIZE]);

        let signature = Signature::sign_message(entropy, sk, message);
        let valid = Signature::verify_signature(pk, signature, message);

        if valid.is_err() {
            println!("{:?}", valid);
        }
        assert!(valid.is_ok());
    }

    #[test]
    fn test_sign_message() {
        // parse the hex value into bytes
        let message =
            hex::decode("D81C4D8D734FCBFBEADE3D3F8A039FAA2A2C9957E835AD55B22E75BF57BB556AC8")
                .unwrap();
        // Feth the seed by decode_to_slice
        let mut seed = [0u8; 48];
        hex::decode_to_slice("061550234D158C5EC95595FE04EF7A25767F2E24CC2BC479D09D86DC9ABCFDE7056A8C266F9EF97ED08541DBD2E1FFA1", &mut seed);
        // print the seed length
        let sk = hex::decode("06A80E69AA864FD9A8ED24508E7CD2955EC7B8C297C5BD6023D8F2E5204625CEDD59E16AC667D78F52259B1636E5D6E60FE9E3EB2110D7C6070354EB1BE9A07D6E5F5EF1F4A418A92E81016BDA7B913A5C07D92512D1F10C72EE104B36D1A99271CF02D643C26452ED5B7C6112A89DB6926313BB755B31DC7E55A8FEE48705430189D3ED5B35D9CA7E039541927B8AE86AC9BF19F3F1D198D3E7B95AAFFB7A2A6E38014B38E0FD8AFC9AB921D1190935137A88EFB6CC624D743D341E85E619B479B41376AF9F0EF69504A322C08F495055A9F1284DEEC5EDE189862C183075C994999F7F7E8BE1610AE47BC460F0319D53DA1E6E7287F431002BFC6E22926F20419700BBC5B820CE392A20253B2549B30F2B69E4BF4EB39AE10E9E32472B2F9C88D63B27FE3B3E93EE43DAAAB17576B3D28A5A2BBCD632C3906111B27E50A8C1790557FC406BC86D5324B6CEDC3959797F3630F4FACD448E81153BDCE55D5D8E9C486C0E9AEDF4ECE7C1F1CD24FF3A5997FADDF7DDCA74649E5832381305B9DF2B79C03AA0B4E1C1CEB13F0A7F695787D247C8678DC96FFB421A34E822F6FACE21520E20E4CC0BB0CCCB5DF2414A68F1").unwrap();
        let sm = hex::decode("18280000D81C4D8D734FCBFBEADE3D3F8A039FAA2A2C9957E835AD55B22E75BF57BB556AC891282214654CB55E7C2CACD53919604D5BAC7B23EEF4B315FEEF5E7D0BB01D75D31A0CAE310989D7A5B5DD8AA3964CECF38DFF12FC9BFB171076AA1375614533B931C7770471CF4FE72ADA410515097FEE1244B9E7FCCF31C5348B52CF7548B57AA41CB1A8C48EC76BA3C65B363006718A5255D17FC6B0C610BDF15B44DD53B36CCB7CEC17D049D1E90F42CD60A80E205736FB42DAB432BBF336E2EB70EF8EDDEEDC1FD859AF8B2CC1A793F50F61DCEDA5BE7CF8CEBBEE915B4BF94F8E07563A3A2E7511D33369366004B350EBCF5CE30300F6FEF5CDD8956B30B5332412AF449025AAC42B7A46C6E78DC79BC6B728A53B401B4F4CAB6FE382703DBEC8FAEAECB4F8DB2C631334A9C342DA3D4C44CC637406BF177D5784C6D1C466A80B29193710E3896A4F463AEB1920A8BAC998323E7840DDA693C30CFED1EAEC448778321298A4C5AD96B9CA26C1EA7A5FB575025E54AC8AAB1C9EA4EB2461F2231EC700B6A772EBB1603A264DAF122AEABF07ED6E220E0A89E90188756BEAA3D900CECDBBCE24464611F4D792BC8B16292EFFBAB5A9277C226007C5587EAEF7B56658E7ADFC607A98A654230D43371FCF995F7CB619DA33AEF0BCB7878C645D190F990196EA04BAE776C5594B2DDEE63913453927CDE1BF28982777E65A1B4E699AD004D229630818E7DA879B8EC309913405D0F732D9B8DDDE33C54F4C26E5E1895B461D648453ADD92AF884E15FF885E5C88B496C0110EA10F67B3A693A48042A8CBAA95BBE6DEB11C2D421EDF56859CBF568526065F73AA6B242C9EE3D05F1EE11BF3AE4C68739541510B9137FE8E4CE767A0394499EF8E802031672ABE81AB3691716EE7628415095BE723C87E56B35301E4D41CF78BF53E1C0ECE1FA5E6AE0E857B89770A13907E7C61DEDCFD85636E8CEF2813C2E44F6273391F1D1F4789459FF343AB0276C5C23E6D451059B5BD0DFD7A0FD573DAE24D0E36DCB8AD0637457F46BE33BE906BE9778A28647F304B2ABFC446EDB80E6121A15686C25394A42D1D1FD31E76B912C3DB3E14264286AE8510A0834759E0174EE745CAB705937EA63E1FA2AEBDA65D33ADB428F13B667D14DC2C0ED06DF7FC4A6BF30BA6AA5EC65CE88C95EB0393A9610D429771F716676E9908603AE3E212C25D73143B77049F7A21B6B39117512E37F751A8BE2AAB951CE1B9FA561BE0F71155569732CC3E15F1F8E05D68CDAE4BFA0715EC6E008A2F106F2C3340414617BA140D24A4303EFD8E7BF077E92DE806B722EC856A98D06FE8F04D34690A9ED24A81C9CF316F0BF6DD6251B0EB4E1FBF128573CCCBF5B027243C368B655E06B8511CE749B798F064796DF55C91102505B704727B998E080DBFBC2358824FB6ADFA216538CA1AAE63CF54F93332D6D87BD7AF1F96F1515B79432593F6E4A53D531F0DB140D75125D4C848186753F284160111572080A8C8CFE7BEEB72FAF0706946B8C0B6908F7BE4069E4778AF493ED0619AAC3C1FDF2833D03E19CE55D8C22E544DB0C946D4DF3CCDE5ACBAC470CF01A4C581788C649AB2839E7493CA66DF23A62F99C66C4213840545FD1E4FBE44D7DAE0DBCB7D2E7792555D117C2DA120D8640A83ED0F7B3D1792C650396D50B46995BF66BD895F8BE3149C61DB0DD1520DBEEA7544472D217E069FB0652ADA0F596ED2B38F89AEEED4E1B95F49AEAEF1671E167EE7530C0B9E2BC0E40237E2EF0F13DD81FE6AFFFACABD8B2800835B8AB0EDA12CA522838CD8F4895D19115247651544535C7FC63113ABE555BB4C56E40E360B2CCDC9F9E5EB2F8FF7AA058ED2E5A666C4F1DB318CCB413FF803EA0AA3A1109ECF5559FEAE73C6EFE4A7257BC18FC981D1DCD06B2E87381E53B248E37F7007F0E5D8E0B4CBEA40ABA3AC2D8011A360D3B41DCE71D253CF87D113C605BC885ACFDE7061EED2CA2829E8272650003273767467527440A6EBCEF00FDA4D4FFEC83E0E05C501C88BF1C9A5F95BEB56EA1BD71B7D224AAC2D7FF961FD9581ED86B2884516F8BFF04CB83E9A23BBA6A750818B105216DE337C022928FF8E5809A61AA2787D1B6DCB93C33787833BA6A6F64E2CE288F31DCCC5ADB0C611CA11401900B8E521F835A81637ADAE6B72732ED96B10C7F89094629C54FDCAF926E95B5CDCCCED3A2024F9EAFA1E54F4C1352A5E197FB518850A55FB54A00C8B9E7BAF8E81D5E0D2E9E0A80EF3C33402C2BB9BC0F304BB6A494F7D3FDE32F29FA176095DC04814EA9DFED12335AD09C9119C2D122B01F6DFBDA1989EE40756CB0340C0DF6E72EFC2E5077D41B73E96A13F5E768F03D0DFCE968CD11EE33FC2A5B4F8DE98DB72E00C5FB53214B633290824841BA7DCC47EC455E5355938820F8A055AD75BAA57D698B2563EDF1DB94CE14FC13334AF2CCA9393F4CB75801297F55997844FF9111E7B44D459DDBCDDE9A5C28E252CF5567593064C52674F6C16A86F4721B3FF3ED72EBA2DA92FAA4D908568C054C4A460EF52AFD966F42DCF183E9A51F9F221803405384A642463098D4EFC10C5DFB012D91F1607BD68B4B15736EEE72D78B0B84531A7B9B6C41B41FC9911734B6A4E77BE361638FE4FDEB6FEE9C85591ACF8EBB2CF2BB60DEB667BA4C65C8514C8F8EAE37B5DC7716B2885E5F23E854445BB7F74C089F1463D8DF4AFBF837195E8C6593B9909011D48489820D38C70E4D3442FBDEA846733DF790E864361EE9327D13865992AEF404C7B831EF0C75671746B921F938A6EFDF321A4F75B4BD77AEB5187C6BE7393A90B5DE0D2862ADF233BBF10C76A7D85FD838764D46F8DD47C546F4C7D8C4DCDFFE9945C26B1492351F740E30415DB9AE013F30F95037CDF07BCA4F09A01ECF27ADF5C8A85A5B2D341562799D4E3CA14F0248EF14086EE3B692070FADC279689E15D68939B5FA53CDF9D5FCB7513D567DDDB3B6BD3DA41B06318BA4C40E0816CAB35C15C9AC43E4976250D28EB5F77B99ED19FF62A6453A3A3643EF45F053C852E555C5B9582087E463BB9581E8BBD9816F04BE3429ECB907288E4C2A8AA1A5F8FF8DF8EF32B80C90CF969BEE95CF803C9FA7E2DB9E2937B86E1406E8DF28DCCD785B443B2D788D4C91F2493511F0216D5435DA1C60FF0283333C56421F62FC324AC68C4F8882F591CC3DB05A083D7E821D85F8493D63F3C46EB7A1099C7AD55FA1F668FF4C54084A5EFF66F4F3E7C325533EC8140645F15AAD9117D1ADEB5F07FAF1A6B92046A6CF09523061EE2B31F1D5A47F3160F70E6078AEDB5EC274D148795BA36308AF8540BF13D396E467B466BAC9BD0AB9CB966EE67761298EC0B7A2A1F63B2B89F0B8AD0D011D69EFF72E1D50C45EFD8A7531AF3C2539E0E4A3D3651353DE668F0BFA0AFD3BFB10C26216B2B305B775A3074D4CF3529313341EC1D2C815332AF2B0818876D065F6D8D2E2DC324234BE851BA9838F7E4B1BFFA490B24730A5FD19B0709C13A51CDB81C19E6563C0A800C642591E4D0627882CC1B4E26C02AAB0874C54427FDAC3F8806C8328C4D97F0AC1521AFF752674BFA0FFB21D95B8443C9A3730A5DE94695BB211E05E3FE66ADEAAE3546032A1E85A0EDE3456549F95D22DB4C5FD6EF2F7F60E0F70AC365DFF093C83D01EB79EB65FD18D227753141179CD7FC05106AD33F0AB3304B035E93643F819812D16A408C9A9E2BC6E4E9301BA76BB931A3D31BA80D920C3D02F400885826FEB85316738DE6B0B1962ED250B8CED47D7B8EA191E9DF9B94774B18F65DCEB7F221C8624D72ADB0E0ABFB0B7A5C5630804EBA9A91B9C970D7F62CDB1FB51AD7D6F45D5187B7A78A9209C322EE9C30CB1063E4BFD01346DA87A1EC48A699D03F7CD4207EC2B5A3161F8D2A3DE54E4D8E65B6545423B2F0012DF28FFE73B2EBAD5EB6E653791159C117D051E0CCD65097B5B32345725365CF2C89E3EFA25C9EE44CDED9220153A07A1519581AD739259EB8119677BAB53328B87F45375EB8F63B33210A1B11EC52A4D4F99480ACB712E2CAE004A550EE1EA2A54D3D6CDBB0E1C8CF78A61C153F65B0E0C00080B73D536198A988782B3D0F2E234F844662461956930AAE7E67A8D742A643485181DEFCFA4FF03C15CD85611DE4095C2B6E88C2BD88E519018D2CC4E62E3DF5FD8220A4C77F58590926C12609D5AE571FECBBDF57CFC729CDFD1122F8FAB10AED73283E4D183CA62F36BFD5CB32D6BE1548DCD2C044E1F8D6EAE9B7EBF36744A2137C49FFF7699B4D2AA92659854980A59360AD745A2014BAD27AD5330329A20A64B14CBD281177830EE279AFFFD163B5328B53D6C09CE4EFCD309384EB0E67695688575E192C4B0560B5C26C9925D50F23C82C15EF81F3A4D3A12C6BAC28EE52DC75D921D703644A330097243BD303E971DB4B6E70CB726A534C0EB8C55246E04D0FC177AD8C4343A9638D4993126B3BECC7BC11E927A67C8165F20AA4510BA2CDBE801FD3E72F18CB1BFABEFD41E0F4D3DFCC79F91F49CCE1A5216A34DDB2D4DA9D7AF5CB293409C6B7D3FFE4A3A66DDDEC18D345C6566E218B04059F07227A9A83CF05966542DC8931AD6AC07F145BC66A86B44D3F5517B18078F187BE4E99C9A83C8A5619E27E78DDD54F8C92173826F49E280DECF9B348C3C855DC79EBC4C659293CCAD78A2900C21DF3E45A673A4CF6D6D2BA4EBFEBF048ED6F83F5FA54DB4173861991831DDF6D0657FB510541F4300F0B94534CC7460FFA89E4BE9413504E9EB15C557D599EE01F60D552C07E60D8AECF27871F7D939DA4B2DF83470B439B8F8966C239C8EA6F99CCDEAA92F44BE1E08E5C72C816D624FF963628DF1593053AA0DA6AC1044F13B8FAE3807F1F67507958DB111799D3B19D276AB7C92A30D2034F24A4D035473FDE3FE538F68767777ABAD975A56428AF1E9B4BDF4AEB729433BD81DD414189B7FA96C258EA30AE98B67EA3A1B1F7B7B4091AD8F0E06A8CD1E8CDD86F486C6EEA7402BB57079983D7335F8CF8766E84B4893E7B6F09E2EBB368DDF9B0A021B20533E7D7AF39F3AD763817F86CD0F8EA46E5786D9F5B7E09FFD1BC24CAAC672B14E7A8DE3EEDFBD74E26D9455E6D3748FDBE66694826E7583F7C5107AB3529AE905084EEB770A53FA8E9718C7E281C40B0C6345EC56958F6417D1F2628254A265790B390050E1A45B1320F9DBF2778253458F72B89F43365D653691E241E496F0513B49199A6437C43FD066ABEF547296028EAF78151641132380E0028AFE130C4A9AFC8A1EA404F71BD102D6422E020E936765F4E2A21FC7CC521A8FCE152E688567DF64312C5AAC48D60E14358FE483D5E0E7D42CA31A4758F913068492F463CD4A8ADD4298965585924013595F8FAB993AB67778617660940B5D9F108E67743EAE4BB0D94E5BF7CBE20C38C393E510CE169B387206E8FA66C0300B39CF7CBA720AB330D0AB5DBCECF9D4503E3DB3954EACE805DA29007D82EE953A82DAD78F8D62172F72D6F06FAD05ED1D982923D8916A510D42568044D00C3E105594CFE7B7E4D05EF66B30D8569D2B1D9B0BD2E9C8BB388E27CA4F516C502A713EA1752FEEB58B86559946219BA34F0AB334FFE3D46E31F1D7459AFB6CE28FD2AB586DDF4DC19694E50B8C130A3959E765E1BC5610F74D1D5301AB4D549DFD705314C85A533047FD4FBA4304B828926CD7D78178BDEB6E08DC02EF994A3C7E98C8A506C6B45DC61515354EDB067968B1E66299878E8EAFEEB03BD67E1859A4016C775439DAA1B5F67B2596B40C9FCB0690A1F299824397ACBAC63703A0644ECDF49EFAA5AEFAC2F2D4DB3BB966C77A49E1AD0D794FC0886B283742D3FF685357ADF7F4183A68E96C7BE5C29BDFF9B7E49393F9AC7BE275E145BADD7B5C0BEC9D81EAAA4E2C5A1A1281914442EC8DB1EF0DBD956CD0BE7C8F9161084795987D60C7D830379A570BAC4B932A64985942128B9787F6C7F0C02EE3583D1005DB1B2A97BA496D3B1DDD9FAB16EF929FA83469C6ED0D64D31202596D410ED39E6E8E8B76F2353FDDB1873A38648A8C54742511DA00A5EE45478534A4BEC848A5B5488086ED7292F17440D56D7338B32C7BCB4199D67489D70FC76314CA9BC8859C38FADECEBF6F5D43FDE7417A3FFEE06FC975F1ADE29608AEBE5F0CDC7D0D4B7FE3415477702C469C679D8A8003B4E5F5DD4B8E1E7882D98318B03DC6580F822A05367A7691A938E233C78523AD57BE115DC0C677EEE9A0FF5D530DD3B6159C1EB654373912A56FC5AAEFB5DD2044FDCB960B6F12B76DB89A96A07243A9F39DF9645FF85CCB223A39B148C704CACE84C99A7600AEC3A50677A85A3C460F96E7D85FDA84D751F19361593C44D6A01571BD4F963748360685CE2C6F37B26ED43EEA291EDA1DE1067428336BA0DFF2045D722CCC6AA9B1B7FE5019312D3299B31A0F6942C449509E3A6ACCD9383A5ADA069C8847CD6EBF1489E60648B41F9FC95514B49D8F27D7B5A190034682D041312FB3C9853BE5587A2429BA0AE64F75D1DF1A065DE2C2921700C07215D9A089C04B9256FE44F21D9257541579EC5B1CE92A2A4B52D61E8F4D0AA7EA890AE6CA192F8640AAD715AF94D1475895732D4B55608BFEB124E91A1E69CC11EEFDF74498A4A07046AFC3D496BCCB6618668648A0003D3AF04DBF36DDD9A9D6ECEB6D9551EA359360B7ABC07D2F69ADAB799A2699D7851362AD952850B5A40BB1E190BB199A17371B519BAE7DFC3AC18DAA14DFC67276A545FE606BAD23EAD92300ED644FCBADC3A4C0C7C9E2563BD4874EA268561ACE9D76B6CD8F6C963A1DE66CE75DAD961DE4F0AD7899BE3B36C701B6A858E01D8721502A643BF2CBDED83070A996A5AD779D7D0F51D97A06741DE25339A87CF9B7C36301F4BD155DEFAA7500848438024B4E8A0266DF3FB8CD1FE839D6FDE0A21508576F9100108A9D2F76E277D6FC482D915C25766DD72B6DEB1DBEAF4A44D89873B5EFE5B02674BF6F1B43DFE4DB422439E0DA7AED9209DDACDBB97D24E202817BCEFC85BAAB98408619B869DB4CC9311D9F8AB110147064842750195B66BDECFB2122C1600CFD33C5074457C32B9629D723DDA0E5483901F2F204594D891787BF681D84CFE1EDF12BD5F726DDB1B7DDE44F83EFF8784A7B80BA9FDE1E0BECD422C2DA27031533EAE43455B2377DED01A3396C37FDCCB70A737D81DCCF023C38A48F006B8555E96AF80AA737B2FEEE710D7912C6FE4A2EBE2F9EBF554E5979ADB98D58575FD3263529BB91242F85D7021E959A17AB4E160CFCA1CEEC4FA59FC5B0D5065C845D1AAF62E7D89C5E28807A17D7AB1FB1194C94C93BE36FDDCF223ACE4AD631D11B64B8CF768BB1FA9842A36E5590E98EFDD6ACE690A0E6BC2F7501E90B5183B18E2C91F0F882E8636359FFCBE8BE3E9A2A48673F191BFDAB9472445A587CC33AF79841567BAF8B74B5D5950A0813F02E8C852206A7FAB42ACE0DEA62219AE98F2E1D76E20CC036CA86E0C13090EF91D4C284EA3BDEAE9292684FB79D595E806646632A73F9910FBA2F332C674B062FF87132FEF8C5B69B42E7E64A82737C6C64EE945DCBC0A2971D9B6E893D897642FBE781BDF2E8CCE778E23F744BCCD2A2CADB2D30C3F2D7E30E6219F71D1BB1B13087ED07DB185946ABC8230695B2C63F672AB7F89A627671DD8D26CDFD285AF5F55BCAFA445B5F97F610038F40F09C34BDC776055C60ACD15DBEB6F007D3F9B9719E7E835852F0B582BF592A5431C274E86AACC122BFA70A6E468AE82C28C20E8FAD56EE452CC71AC22E24DB35D4FA97835DE73224BDDACC075DE2BFBA4267D47C5911A28B5754938170F62D243B7F316F23708B8DF2A114CDF221AC747269841BA69B6F97D4CC732A3179BE44FEFC463C40D31A96771198E9315F0BE97C1447CCB7DF9F18E433B38FA46A5294D7E80045FF4DF6A2DA4865D6871A6E83CFFD8E4C92ECA6D2D752B325634AC82FD2E52B26E1E854DD0041FD12EFC356ADD34329109E320D2F1341DED61E6A28A5876116A598FEB6F890A89EF978AEAD904F5A534BF610FDAB6C97575BC5683E3B949C9FE4B25D3D9F35048A4F2A03B1A3209A010A0C9612EB3BD35AAF7A45B3A60B6A363DA1BF49E1E08977EE2939CC0214307BFC9709BFA6E16B0BC1F9977B2510909EB111DFFD8B69566B9AF7E444986BA31EB66497AE7BD413441E77428C5279376AC898677E6467FBAE0588ADC8A51504EA281659DC3689E37D35927CD8B823516E7B0F18BCB149FCB1926CF8B50C2550444D443A64F3F3EBB4369642BCE1BC85D6A0E9E070EE0BC2A4885FF762E153414931F5C8A521708853BA3FAD7DD71E659DB78C601A0C8B42FC4D32329C01F172733A28EC505F0FA23292E0AC1297A6ACDAD20053177374FF87E09F2ADB797FC36BEDFDACC05ED5A95FEC8ED8568244E4C0278128DCE2391E9D0F0BD0A2B2EB55F533D2274BD8DC1FA6251C89F88BF03D80F5C58F3EA54B551D516322C6B10CE421B24637F571040DDBFC21AB6383D602CE7F70D2624A50CCAEBDB0F5BB949277D1A1FF9FCED2EB1D681C8268F37E1FE7114064CF6BF59DC48C74F9A3F3CB4B080A0C0FB78429C1088BDFE926DF8F19E1818EACAEBB9D66FFBB40F82D079AC52486C9E9606F2168ABF097EEBA5E4DEB0B02E1A17FBCF2ECD76408E88AF4A9AD6577E4CC1CEA564EC34DE2BC7C774A2289A21986F0786D308F295580EEE5744AD85A6575A832A1B0E9466BB9BBAC2497BC907DC75CC538E231C3562E6C8733D69769FA07311FFF047C6D2ABD21A72C35256D35D0A69B1B4EEA55A18018BE7320BAA928B8FBBF34D44E5CCCDF6764C0C8AD8FA620D64BC50B60383EF809C92B6101870FC8B8AAD51D819F6E1FFD5EF3EA3D41C41923BF34B85B14D75838052A600A40CDA2270A75298A0870A63084A646C02978A3F88A2DA723C8B0C327F66E4C012FDCF55F3E4CEAE55834FB62F3D9A25A755C43A64CFBC6553336DA1C32345091540E5EE55A67A5A96F623EFC345DCDDDFF712D27B7EF6034904E8D881DF4782A8438E7FBDF6616FC1F943AF6A1AD53202FC515BFD7A5554A9992F4911313CA3AE1BB76326A44C49D6DC3205E24D15CE701A0434EF846F14297347537859E5E8BDC8307FE4A53AB9254B1958AB9B8B7B76F86E60BB05271100C94FD548BB20FB9EA51B71DA863B5406F661805B6E79DFB9A5AC75A25FB087B7D4D8B8B5D273E253BA223F938CDB68FB657FD8CC676C77CDE203317F0BFB5FA669A3B384154E6AE1E674C390B0C0D8CC43CD075C84524BA6E83978B9C6A81A5639F9E5D9FCD96784A7979D30EE6C99371A2540958D7934DB71FEE6430AD1FD78E6AF28E26D5A9911EDD16AD01E0F0A564819013E1C6EF28BA48F1A12D263BC87E8EF5376A70DA855DF9A760A07749D4205C83DB12B20894331A1DA0618F57017E6C5A8A38BEB18D9A13D56AF139BB0423F95C5E6B61E93BB607D6699B56C995E8536E127F514F36DAEC22A37EE87FEF4E928EDCB9587D42C6BCA1C07E15896D4052F9E1ECD63B98C82811C90293F9896F2806A20B3D53BAD0380F168C6E1D13F5C0412BBCFDDA96DCA5C55D6A2E028E520D8AE7B39F0E2C17171A4F79549E467FECAE01FA31B147306E2B132D96191DF3C84EA2A0E6FC5FE86AA090BC540DE07B12D70C4EBDF7022F5287E44FE405DFA41029B15681EB29F44EC8B14EAB29F1B01572688D861CA1B83FA822BCBF425D55D19CB60040940AAD45FAD0AFE36D9D3785908827DC0258BAAD4D6458F266B5149C1E72D4CC250E573BDF77DDC40DB39653CA970A3A843FB3871AD3FF18C5A36B4CC94F3E8EB6AA66FAF37234794380EF196CE0657A3524A4C89465CF75F4FB15B5A94ECF8D152480B244800E90E8FF8EBEA91ADB146F5E2CD021C0A129885C4D86269CF335092C5188FED957CD9EEF11FEC25326433BFA153881267069B26B6A173267CF0A1F6382BE2C3F56C61F8545E04B366A66B10093F69321C2E0451DD7574A41803E94636DDD662E5DD9E3CBD1E1AE69EABD9F0C630F380F5279C0E4F6D808C9B109C221E897EEAEC2CB0AD446533CEDECE791D35C9C1C785448B3AB9D0CB72169818674AE3F17C85ED390A4235A713FEB0793C1B68E2667153BAACB4068BF101386A740CB6A954642616BDDBF919785F1E222649719F38BAFB5A0DB3539D25C5C03CE7FBC673A6111FC7192EBB51E179D00711FA95A47FFBB0BA4B68036734EB6AC1D9DD7EDAD901C2074580A4A00A290F2180C235EB1D48F878B441B015F17801E38A36B288619E1B7CD88B7314F607B3A84DA3A438DB188D154067D471D8E27F98C1BD024445E0A8FA60D9793929DEB75DD10856E12FE95D4423708FD1D4E7CD1190389B334E89FDE52730D3A5805B82AF423BC3AA17CC2B5F81BE5E42EA7AC9B3242A586B9BA84C0B6047F1F443A535EC0C6B8B10F133A1160EB70F478124FECC2DB77716D70D28A9BFD2F8CB1CA4CFC4C1C7355B169E13F5475D8FC47D87E5CF4259255F9ADB62FC195764CD461D7F4D934ACE59A8BEA40D8E1074276F93C6F2E1892A91C656A2BFE23496439D7F5FB5D765B3F066179F27E27411B36119D3C624BE4CA45B700A340EC387F40A50CEE6A001F1A59A5B26C5A0952644E4CB174421D62BFA32577F9109E094F4F57687653FC07FCAD3F99F5F3B643E1E931DD050AB4D42DF26B1BEE4FAAD9971FCC06A338D6D1863B9F82FE1E68AE7C45563142DF650916C87A6427BA7A3B5856666309330264FB9CB46CD9B8A58DA65BEAFC7CEABDDEA11910C5AE12D423AA687F500A5EB8D0A66E915864B8E67B30A0B5A2F7BFE8DF1837200AAE6BFA2D39410877B465C3F629B2C535DBAE9DFAD781501685473200BFFCE204F4E6C59FE71E977C838465D1FE995435D8C254C01A718C5FA9DA5890207EC377DC597B02FBCF3A263EF8ECD304B88B0CA235F2C77C33DF8209F42C0F6988898FD4D77F522D2A8354CCF0ED5684E11F81DF78CDB02816594255B9C60735EB013D1E92B6D06E171397A9050777CE96795F10ED11B48036B8E0241FD38F05E9E353869C0A5CB6361203B4D82E8450434278C114C644C68EC7C93B20FE7E2E50E29AC03E0832C1C77D132195DBDB739A22851B11AC3D5B2389AC3DAA791EA04CD7543FDA8DD0450002CAF580B993090B479D4B7CAADB9305A5F7B1C18287D1243FD45608F1EF5FF1257D6760835C57A24EE3F825EB64861BF5F9B34E8F8095AFB32037351C4F1DBDEE7025F296110DAFF8F67F01483EBAC6719D878EE43E6562E1C3D848031960734568911BE64848E7B2294297003A77503FD2CF80335A631CE4B4C55C46D84A509A7ACC7E50D452915E2E9A30C45446CF05463BA64DACA036F27F629A13F30D21800BFE51719F6BC280DD1730649F0309E6D3556319B7D17CED56E86D3BA2AC6DD98AA11A80FD38B73148908B1F9423493D5928F3EDAA8EF878BC88ACE02410A204B370609CC196503A1DD547C9CE1280722E7B214B21CA6C9DAF981AF9B63E08CFDD7B5D0A2975B6D24CCFEFA5E02B974E106D8E93694045D3947D2020674745B445817067B82626C4CE763BE68DCC2782534D5A77273A279E489679295C45C2C77100A5EFEB5481F500E12720490107C129246770E824308E982D1A355117D0C3FE6E0DDB422F5C4014E36EBE77A2CF6FDBE9C3D05C106D3E6CB707B7B6D1492ACF66E069D9F73FA6F8928DB83D59796AA368576C165B98C766166CBE7612F27650530D3D0D117906DFED34787A08EC4E8A7DA97BFA2625F163879715DF121C17127331930D3BBEB894B41E8FC1F921EDB21BFE63217E9093EA2D37C2AAF85284547B0861C824A8875437BE122F636E077E67AAE13047AB240F332A0AEA81D722D37CF91E120CD92594AA37D3ACFEDFC2FB174E9A38BD9520366CF39E789494B24C82F9A8377D0B1AD08882AA1DA3DAFBEC400B1A57D176D33686F421788445F0775BA9648D943D28809ABA417EE0BCA0584801F58857747599A7F5FC74C8B575C31DEF62E6FE046E1FA220330A6F8E9C7A153403CD296519F464A2D65499196695CC54C5090E1CD807528FA45746F9D721F411E2610C70A8363244E0A354DB72E299A8004B6D13638332FE3621AFDCC23601338A5C69A9CC1884A192AA74005BA63FDF3B698B70D81CD0F76BF9C9AA76B79ECADC154CBBBDA10C9B270665E64784E46AEDACA3E46CF5BDEA3919241E209C606ED184E7780FC29FEAE83C1A500EACFFECE76C111C0D8643FB37DD045EE06EA5D516384E6F5A5A9BD16ED64FB180F466E83B085A5961A424E158866A2B4D048FDA5F7CEB2C6A5C8F58791D62463AAC59797489C3146B04295A568AFD3D72256B0D30439DCC9E120B84BF048552E37BA7F414747A39BFBB6710CD1A6FDC97983CF5A1DE85C502AECE0E01373E91E5B283544C740FE7E5D983B9491133D4BD95CC320F7D1F36AB2F665D86C38F7D49916F3F229CF7A07D65BB4C35ED22C0E853D796A3C3B778529605FEEA93C5E3FBF7A984F496F17BBE55D41C824CC445A8094F5BCD2E88A7382155CCA89EECABCD237CB00563172C0C64A303CA5D21B962E1593A48D313F272FFB3104DC40A23E1FF8839CAC278F989583D3054CFDEC65D68FEB984EFC1D4AE3C11BB12F60EB96B98B5568B1D88C4E8AE5A9EA4AA1B25E54D963D73855EEC324DDD873C488006A3C2E0B3D28DA0493E1DAF1C1CC3C58D3D8A209F18DB719DCD5DA355FD8CE70BCAB5108F9E5DD7D55F9346D77F13695F51B3500DD72E012F2D39DF224CF4A0032965A55DBB21BA8422E2703BCA4221D97A42268CBEF7E7C5E968B03D362DD1355DF70D34513C4F3C6DE7783A014481FF68B62B50FF07C970DBA0D5E2D6F66C98EBF3040FE4B4290A78C4AF642D705EE80C525F5BDF88DEEFCAEF54C6EDEDC6182179A510EDEEE625F431F36D0F4606B5C9BC8F5D38A2069BA8F3730F65BFAB7919083A63D6538FC477AD838531732A36378AEFB4FAA5550283CD537B52A9C98E45E426B8631F9509304BA773E8C5DD9262D908C38BF41E082B52AD06944EBC184E18190BEBC3E6EBB18CF00DC36F5C098BC70D806E63BC8298194FCF54500371B49B6650741A01ED6C05F514BC81E4418EC2E7A14DFFF0E8394E3B96A08927CF92916FDB3071E5F356862C7F15EC3F5C83B1BF599AED478903D77C88A52709E649752099DE4344B9FCFD480E1AEF95A116E7CD7A8DA3DEA6868C5E3E1B8718E05E87B90FE125ECCC0662CF90D7842C0048083FBC975A96806D12482F5E6270D421E5D0A0EBFCF1515EC2C82CCC6CC2E542BF8EABBF5317421C2CFF56B2AF75CC4AC767871E17202E2FA8091844393E35F44BD36C3B41D009B73DC7E0C67E78D4D11A9BE016BE1D51F27EF6EB76B6A8AD1AE81426230FBAC4E0060C5E4DD9FD21DB692A0DB00254E8C7C1888C24EE66AA946CFC30BFF411D9A4D8282A8E47BA5DAB37DD7E969A394B4F63CCFEFA1243688C43173121A2C134CC35C2A622C805ABCF1F28FE842CED6BB86C587F1160EA46BD8566294242C6508CB23C879A37CEDA76F47DB3E64C40A9E9D14C742706E07520D62D24E6CC67111A6806B4C22CC0705CDB9C24AD948419CED06F49E31CCABE7CFA36EB67260A95B863E62F816F9A3F76888334CAE1AB333077DEB427DF1F793B533582F9D60DCF0296043359EF5528E30FF552178EC1DF5B4CB0FEE03C9F02A44EDCDCD5925689354B9E9D440EA4A3B7B88EE92233317AE8CB055DB17CF7ACACB8B1761B44D767844DB8E61C309CC298E9B998B744AC389694C4F6EF44ACA629B675AEF7D52F90AE8B0AB522DFAA499AD4FD80C190CD35AEA13D8DC23575E98CEDD722671DB3DC5F622DA239A448DBDDEC26A8ED194049D9CD1F2118406A33A6E2F2B291D9D767DDDEAA116574C196C78EFD8A17C8CE4F56E6DC0C6A9E2107EDCC18F8E4565196B29B08B93EBAF5EB8B964D5D0BD456FF7FAFDEB716E726DDF1DA3F07E466BF281744BF1DF84E32584C598A53D8B5FA555795E40C5F7A3C5668E90B059B7E18194E5BF89B3462D469C2AC0F2D9AC21E812B35D67F61B819FC40CE511905326819E14B5194D18A16EEE9686B766467E2A76D9E9587329374BDB6C2A4FEAB4C86F3FC65FC92BC39C719FC02DDEB16EF8E996D88D56A9F7D8C75ED7294861B7E726C818745C36A65150DDFF3CB173EE0FE3CFD504DF72A8DB5C52DA882F6B0FA8F9E8C0B5323922ECB88CE67472909B2D9E49BC4605FD75E3D20DD1600826CA234CD3A6CE666B01B3975C3625D598C2DABD37BF39D18B0DA500F064BFA8A356A96F2645C00B040B973B8E591DE0A97AE7CB76D65D4A5D0ABF284E5C740FFDA8FE3E93A42676C0397A4BCAF230891365108FC92FE3A6A63E99DE5F9FD399B364284409EDCEBDC7780D79BDEF1AFAEBC15E02E4FB838C097EC1E5DBCCF129C130F50C90FEFC75232AEC99D603AC0287A7424B93A1E01A2AF9B472FD1E9B4CA4CFA6845A14FBF36F1CBC36F8222FE3C5DE0D8D023D03336FF4E0B8650344095C5D0C09DAF2F").unwrap();
        let seed: nist_pqc_seeded_rng::Seed = seed.into();
        let mut rng = NistPqcAes256CtrRng::from_seed(seed);

        let mut master_seed = [0u8; PARAM_SEED_SIZE];
        rng.fill_bytes(&mut master_seed);
        let (_, sk) = keygen::keygen(master_seed);
        let mut seed_root = [0u8; PARAM_SEED_SIZE];
        let mut salt = [0u8; PARAM_SALT_SIZE];
        rng.fill_bytes(&mut seed_root);
        rng.fill_bytes(&mut salt);
        let entropy = (seed_root, salt);

        // Fetch the message from the sm after the smlen and to the message length
        let sig_message = &sm[4_usize..message.len() + 4];
        assert_eq!(message, sig_message);

        let signature_to_parse = sm[4 + message.len()..].to_vec();
        let parsed_signature = Signature::parse(signature_to_parse, &message);
        // Compare bytes in sm with the serialised, and output when they differ

        // Now compute the signature based on the information given above
        let signature = Signature::sign_message(entropy, sk, &message);

        assert_eq!(parsed_signature.salt, signature.salt);
        assert_eq!(parsed_signature.h1, signature.h1);
        assert_eq!(parsed_signature.broadcast_plain, signature.broadcast_plain);
        assert_eq!(
            parsed_signature.broadcast_shares,
            signature.broadcast_shares
        );
        assert_eq!(parsed_signature.auth, signature.auth);
    }

    #[test]
    fn test_parse_serialise() {
        // Parse hex values
        let message =
            hex::decode("D81C4D8D734FCBFBEADE3D3F8A039FAA2A2C9957E835AD55B22E75BF57BB556AC8")
                .unwrap();
        let sm = hex::decode("18280000D81C4D8D734FCBFBEADE3D3F8A039FAA2A2C9957E835AD55B22E75BF57BB556AC891282214654CB55E7C2CACD53919604D5BAC7B23EEF4B315FEEF5E7D0BB01D75D31A0CAE310989D7A5B5DD8AA3964CECF38DFF12FC9BFB171076AA1375614533B931C7770471CF4FE72ADA410515097FEE1244B9E7FCCF31C5348B52CF7548B57AA41CB1A8C48EC76BA3C65B363006718A5255D17FC6B0C610BDF15B44DD53B36CCB7CEC17D049D1E90F42CD60A80E205736FB42DAB432BBF336E2EB70EF8EDDEEDC1FD859AF8B2CC1A793F50F61DCEDA5BE7CF8CEBBEE915B4BF94F8E07563A3A2E7511D33369366004B350EBCF5CE30300F6FEF5CDD8956B30B5332412AF449025AAC42B7A46C6E78DC79BC6B728A53B401B4F4CAB6FE382703DBEC8FAEAECB4F8DB2C631334A9C342DA3D4C44CC637406BF177D5784C6D1C466A80B29193710E3896A4F463AEB1920A8BAC998323E7840DDA693C30CFED1EAEC448778321298A4C5AD96B9CA26C1EA7A5FB575025E54AC8AAB1C9EA4EB2461F2231EC700B6A772EBB1603A264DAF122AEABF07ED6E220E0A89E90188756BEAA3D900CECDBBCE24464611F4D792BC8B16292EFFBAB5A9277C226007C5587EAEF7B56658E7ADFC607A98A654230D43371FCF995F7CB619DA33AEF0BCB7878C645D190F990196EA04BAE776C5594B2DDEE63913453927CDE1BF28982777E65A1B4E699AD004D229630818E7DA879B8EC309913405D0F732D9B8DDDE33C54F4C26E5E1895B461D648453ADD92AF884E15FF885E5C88B496C0110EA10F67B3A693A48042A8CBAA95BBE6DEB11C2D421EDF56859CBF568526065F73AA6B242C9EE3D05F1EE11BF3AE4C68739541510B9137FE8E4CE767A0394499EF8E802031672ABE81AB3691716EE7628415095BE723C87E56B35301E4D41CF78BF53E1C0ECE1FA5E6AE0E857B89770A13907E7C61DEDCFD85636E8CEF2813C2E44F6273391F1D1F4789459FF343AB0276C5C23E6D451059B5BD0DFD7A0FD573DAE24D0E36DCB8AD0637457F46BE33BE906BE9778A28647F304B2ABFC446EDB80E6121A15686C25394A42D1D1FD31E76B912C3DB3E14264286AE8510A0834759E0174EE745CAB705937EA63E1FA2AEBDA65D33ADB428F13B667D14DC2C0ED06DF7FC4A6BF30BA6AA5EC65CE88C95EB0393A9610D429771F716676E9908603AE3E212C25D73143B77049F7A21B6B39117512E37F751A8BE2AAB951CE1B9FA561BE0F71155569732CC3E15F1F8E05D68CDAE4BFA0715EC6E008A2F106F2C3340414617BA140D24A4303EFD8E7BF077E92DE806B722EC856A98D06FE8F04D34690A9ED24A81C9CF316F0BF6DD6251B0EB4E1FBF128573CCCBF5B027243C368B655E06B8511CE749B798F064796DF55C91102505B704727B998E080DBFBC2358824FB6ADFA216538CA1AAE63CF54F93332D6D87BD7AF1F96F1515B79432593F6E4A53D531F0DB140D75125D4C848186753F284160111572080A8C8CFE7BEEB72FAF0706946B8C0B6908F7BE4069E4778AF493ED0619AAC3C1FDF2833D03E19CE55D8C22E544DB0C946D4DF3CCDE5ACBAC470CF01A4C581788C649AB2839E7493CA66DF23A62F99C66C4213840545FD1E4FBE44D7DAE0DBCB7D2E7792555D117C2DA120D8640A83ED0F7B3D1792C650396D50B46995BF66BD895F8BE3149C61DB0DD1520DBEEA7544472D217E069FB0652ADA0F596ED2B38F89AEEED4E1B95F49AEAEF1671E167EE7530C0B9E2BC0E40237E2EF0F13DD81FE6AFFFACABD8B2800835B8AB0EDA12CA522838CD8F4895D19115247651544535C7FC63113ABE555BB4C56E40E360B2CCDC9F9E5EB2F8FF7AA058ED2E5A666C4F1DB318CCB413FF803EA0AA3A1109ECF5559FEAE73C6EFE4A7257BC18FC981D1DCD06B2E87381E53B248E37F7007F0E5D8E0B4CBEA40ABA3AC2D8011A360D3B41DCE71D253CF87D113C605BC885ACFDE7061EED2CA2829E8272650003273767467527440A6EBCEF00FDA4D4FFEC83E0E05C501C88BF1C9A5F95BEB56EA1BD71B7D224AAC2D7FF961FD9581ED86B2884516F8BFF04CB83E9A23BBA6A750818B105216DE337C022928FF8E5809A61AA2787D1B6DCB93C33787833BA6A6F64E2CE288F31DCCC5ADB0C611CA11401900B8E521F835A81637ADAE6B72732ED96B10C7F89094629C54FDCAF926E95B5CDCCCED3A2024F9EAFA1E54F4C1352A5E197FB518850A55FB54A00C8B9E7BAF8E81D5E0D2E9E0A80EF3C33402C2BB9BC0F304BB6A494F7D3FDE32F29FA176095DC04814EA9DFED12335AD09C9119C2D122B01F6DFBDA1989EE40756CB0340C0DF6E72EFC2E5077D41B73E96A13F5E768F03D0DFCE968CD11EE33FC2A5B4F8DE98DB72E00C5FB53214B633290824841BA7DCC47EC455E5355938820F8A055AD75BAA57D698B2563EDF1DB94CE14FC13334AF2CCA9393F4CB75801297F55997844FF9111E7B44D459DDBCDDE9A5C28E252CF5567593064C52674F6C16A86F4721B3FF3ED72EBA2DA92FAA4D908568C054C4A460EF52AFD966F42DCF183E9A51F9F221803405384A642463098D4EFC10C5DFB012D91F1607BD68B4B15736EEE72D78B0B84531A7B9B6C41B41FC9911734B6A4E77BE361638FE4FDEB6FEE9C85591ACF8EBB2CF2BB60DEB667BA4C65C8514C8F8EAE37B5DC7716B2885E5F23E854445BB7F74C089F1463D8DF4AFBF837195E8C6593B9909011D48489820D38C70E4D3442FBDEA846733DF790E864361EE9327D13865992AEF404C7B831EF0C75671746B921F938A6EFDF321A4F75B4BD77AEB5187C6BE7393A90B5DE0D2862ADF233BBF10C76A7D85FD838764D46F8DD47C546F4C7D8C4DCDFFE9945C26B1492351F740E30415DB9AE013F30F95037CDF07BCA4F09A01ECF27ADF5C8A85A5B2D341562799D4E3CA14F0248EF14086EE3B692070FADC279689E15D68939B5FA53CDF9D5FCB7513D567DDDB3B6BD3DA41B06318BA4C40E0816CAB35C15C9AC43E4976250D28EB5F77B99ED19FF62A6453A3A3643EF45F053C852E555C5B9582087E463BB9581E8BBD9816F04BE3429ECB907288E4C2A8AA1A5F8FF8DF8EF32B80C90CF969BEE95CF803C9FA7E2DB9E2937B86E1406E8DF28DCCD785B443B2D788D4C91F2493511F0216D5435DA1C60FF0283333C56421F62FC324AC68C4F8882F591CC3DB05A083D7E821D85F8493D63F3C46EB7A1099C7AD55FA1F668FF4C54084A5EFF66F4F3E7C325533EC8140645F15AAD9117D1ADEB5F07FAF1A6B92046A6CF09523061EE2B31F1D5A47F3160F70E6078AEDB5EC274D148795BA36308AF8540BF13D396E467B466BAC9BD0AB9CB966EE67761298EC0B7A2A1F63B2B89F0B8AD0D011D69EFF72E1D50C45EFD8A7531AF3C2539E0E4A3D3651353DE668F0BFA0AFD3BFB10C26216B2B305B775A3074D4CF3529313341EC1D2C815332AF2B0818876D065F6D8D2E2DC324234BE851BA9838F7E4B1BFFA490B24730A5FD19B0709C13A51CDB81C19E6563C0A800C642591E4D0627882CC1B4E26C02AAB0874C54427FDAC3F8806C8328C4D97F0AC1521AFF752674BFA0FFB21D95B8443C9A3730A5DE94695BB211E05E3FE66ADEAAE3546032A1E85A0EDE3456549F95D22DB4C5FD6EF2F7F60E0F70AC365DFF093C83D01EB79EB65FD18D227753141179CD7FC05106AD33F0AB3304B035E93643F819812D16A408C9A9E2BC6E4E9301BA76BB931A3D31BA80D920C3D02F400885826FEB85316738DE6B0B1962ED250B8CED47D7B8EA191E9DF9B94774B18F65DCEB7F221C8624D72ADB0E0ABFB0B7A5C5630804EBA9A91B9C970D7F62CDB1FB51AD7D6F45D5187B7A78A9209C322EE9C30CB1063E4BFD01346DA87A1EC48A699D03F7CD4207EC2B5A3161F8D2A3DE54E4D8E65B6545423B2F0012DF28FFE73B2EBAD5EB6E653791159C117D051E0CCD65097B5B32345725365CF2C89E3EFA25C9EE44CDED9220153A07A1519581AD739259EB8119677BAB53328B87F45375EB8F63B33210A1B11EC52A4D4F99480ACB712E2CAE004A550EE1EA2A54D3D6CDBB0E1C8CF78A61C153F65B0E0C00080B73D536198A988782B3D0F2E234F844662461956930AAE7E67A8D742A643485181DEFCFA4FF03C15CD85611DE4095C2B6E88C2BD88E519018D2CC4E62E3DF5FD8220A4C77F58590926C12609D5AE571FECBBDF57CFC729CDFD1122F8FAB10AED73283E4D183CA62F36BFD5CB32D6BE1548DCD2C044E1F8D6EAE9B7EBF36744A2137C49FFF7699B4D2AA92659854980A59360AD745A2014BAD27AD5330329A20A64B14CBD281177830EE279AFFFD163B5328B53D6C09CE4EFCD309384EB0E67695688575E192C4B0560B5C26C9925D50F23C82C15EF81F3A4D3A12C6BAC28EE52DC75D921D703644A330097243BD303E971DB4B6E70CB726A534C0EB8C55246E04D0FC177AD8C4343A9638D4993126B3BECC7BC11E927A67C8165F20AA4510BA2CDBE801FD3E72F18CB1BFABEFD41E0F4D3DFCC79F91F49CCE1A5216A34DDB2D4DA9D7AF5CB293409C6B7D3FFE4A3A66DDDEC18D345C6566E218B04059F07227A9A83CF05966542DC8931AD6AC07F145BC66A86B44D3F5517B18078F187BE4E99C9A83C8A5619E27E78DDD54F8C92173826F49E280DECF9B348C3C855DC79EBC4C659293CCAD78A2900C21DF3E45A673A4CF6D6D2BA4EBFEBF048ED6F83F5FA54DB4173861991831DDF6D0657FB510541F4300F0B94534CC7460FFA89E4BE9413504E9EB15C557D599EE01F60D552C07E60D8AECF27871F7D939DA4B2DF83470B439B8F8966C239C8EA6F99CCDEAA92F44BE1E08E5C72C816D624FF963628DF1593053AA0DA6AC1044F13B8FAE3807F1F67507958DB111799D3B19D276AB7C92A30D2034F24A4D035473FDE3FE538F68767777ABAD975A56428AF1E9B4BDF4AEB729433BD81DD414189B7FA96C258EA30AE98B67EA3A1B1F7B7B4091AD8F0E06A8CD1E8CDD86F486C6EEA7402BB57079983D7335F8CF8766E84B4893E7B6F09E2EBB368DDF9B0A021B20533E7D7AF39F3AD763817F86CD0F8EA46E5786D9F5B7E09FFD1BC24CAAC672B14E7A8DE3EEDFBD74E26D9455E6D3748FDBE66694826E7583F7C5107AB3529AE905084EEB770A53FA8E9718C7E281C40B0C6345EC56958F6417D1F2628254A265790B390050E1A45B1320F9DBF2778253458F72B89F43365D653691E241E496F0513B49199A6437C43FD066ABEF547296028EAF78151641132380E0028AFE130C4A9AFC8A1EA404F71BD102D6422E020E936765F4E2A21FC7CC521A8FCE152E688567DF64312C5AAC48D60E14358FE483D5E0E7D42CA31A4758F913068492F463CD4A8ADD4298965585924013595F8FAB993AB67778617660940B5D9F108E67743EAE4BB0D94E5BF7CBE20C38C393E510CE169B387206E8FA66C0300B39CF7CBA720AB330D0AB5DBCECF9D4503E3DB3954EACE805DA29007D82EE953A82DAD78F8D62172F72D6F06FAD05ED1D982923D8916A510D42568044D00C3E105594CFE7B7E4D05EF66B30D8569D2B1D9B0BD2E9C8BB388E27CA4F516C502A713EA1752FEEB58B86559946219BA34F0AB334FFE3D46E31F1D7459AFB6CE28FD2AB586DDF4DC19694E50B8C130A3959E765E1BC5610F74D1D5301AB4D549DFD705314C85A533047FD4FBA4304B828926CD7D78178BDEB6E08DC02EF994A3C7E98C8A506C6B45DC61515354EDB067968B1E66299878E8EAFEEB03BD67E1859A4016C775439DAA1B5F67B2596B40C9FCB0690A1F299824397ACBAC63703A0644ECDF49EFAA5AEFAC2F2D4DB3BB966C77A49E1AD0D794FC0886B283742D3FF685357ADF7F4183A68E96C7BE5C29BDFF9B7E49393F9AC7BE275E145BADD7B5C0BEC9D81EAAA4E2C5A1A1281914442EC8DB1EF0DBD956CD0BE7C8F9161084795987D60C7D830379A570BAC4B932A64985942128B9787F6C7F0C02EE3583D1005DB1B2A97BA496D3B1DDD9FAB16EF929FA83469C6ED0D64D31202596D410ED39E6E8E8B76F2353FDDB1873A38648A8C54742511DA00A5EE45478534A4BEC848A5B5488086ED7292F17440D56D7338B32C7BCB4199D67489D70FC76314CA9BC8859C38FADECEBF6F5D43FDE7417A3FFEE06FC975F1ADE29608AEBE5F0CDC7D0D4B7FE3415477702C469C679D8A8003B4E5F5DD4B8E1E7882D98318B03DC6580F822A05367A7691A938E233C78523AD57BE115DC0C677EEE9A0FF5D530DD3B6159C1EB654373912A56FC5AAEFB5DD2044FDCB960B6F12B76DB89A96A07243A9F39DF9645FF85CCB223A39B148C704CACE84C99A7600AEC3A50677A85A3C460F96E7D85FDA84D751F19361593C44D6A01571BD4F963748360685CE2C6F37B26ED43EEA291EDA1DE1067428336BA0DFF2045D722CCC6AA9B1B7FE5019312D3299B31A0F6942C449509E3A6ACCD9383A5ADA069C8847CD6EBF1489E60648B41F9FC95514B49D8F27D7B5A190034682D041312FB3C9853BE5587A2429BA0AE64F75D1DF1A065DE2C2921700C07215D9A089C04B9256FE44F21D9257541579EC5B1CE92A2A4B52D61E8F4D0AA7EA890AE6CA192F8640AAD715AF94D1475895732D4B55608BFEB124E91A1E69CC11EEFDF74498A4A07046AFC3D496BCCB6618668648A0003D3AF04DBF36DDD9A9D6ECEB6D9551EA359360B7ABC07D2F69ADAB799A2699D7851362AD952850B5A40BB1E190BB199A17371B519BAE7DFC3AC18DAA14DFC67276A545FE606BAD23EAD92300ED644FCBADC3A4C0C7C9E2563BD4874EA268561ACE9D76B6CD8F6C963A1DE66CE75DAD961DE4F0AD7899BE3B36C701B6A858E01D8721502A643BF2CBDED83070A996A5AD779D7D0F51D97A06741DE25339A87CF9B7C36301F4BD155DEFAA7500848438024B4E8A0266DF3FB8CD1FE839D6FDE0A21508576F9100108A9D2F76E277D6FC482D915C25766DD72B6DEB1DBEAF4A44D89873B5EFE5B02674BF6F1B43DFE4DB422439E0DA7AED9209DDACDBB97D24E202817BCEFC85BAAB98408619B869DB4CC9311D9F8AB110147064842750195B66BDECFB2122C1600CFD33C5074457C32B9629D723DDA0E5483901F2F204594D891787BF681D84CFE1EDF12BD5F726DDB1B7DDE44F83EFF8784A7B80BA9FDE1E0BECD422C2DA27031533EAE43455B2377DED01A3396C37FDCCB70A737D81DCCF023C38A48F006B8555E96AF80AA737B2FEEE710D7912C6FE4A2EBE2F9EBF554E5979ADB98D58575FD3263529BB91242F85D7021E959A17AB4E160CFCA1CEEC4FA59FC5B0D5065C845D1AAF62E7D89C5E28807A17D7AB1FB1194C94C93BE36FDDCF223ACE4AD631D11B64B8CF768BB1FA9842A36E5590E98EFDD6ACE690A0E6BC2F7501E90B5183B18E2C91F0F882E8636359FFCBE8BE3E9A2A48673F191BFDAB9472445A587CC33AF79841567BAF8B74B5D5950A0813F02E8C852206A7FAB42ACE0DEA62219AE98F2E1D76E20CC036CA86E0C13090EF91D4C284EA3BDEAE9292684FB79D595E806646632A73F9910FBA2F332C674B062FF87132FEF8C5B69B42E7E64A82737C6C64EE945DCBC0A2971D9B6E893D897642FBE781BDF2E8CCE778E23F744BCCD2A2CADB2D30C3F2D7E30E6219F71D1BB1B13087ED07DB185946ABC8230695B2C63F672AB7F89A627671DD8D26CDFD285AF5F55BCAFA445B5F97F610038F40F09C34BDC776055C60ACD15DBEB6F007D3F9B9719E7E835852F0B582BF592A5431C274E86AACC122BFA70A6E468AE82C28C20E8FAD56EE452CC71AC22E24DB35D4FA97835DE73224BDDACC075DE2BFBA4267D47C5911A28B5754938170F62D243B7F316F23708B8DF2A114CDF221AC747269841BA69B6F97D4CC732A3179BE44FEFC463C40D31A96771198E9315F0BE97C1447CCB7DF9F18E433B38FA46A5294D7E80045FF4DF6A2DA4865D6871A6E83CFFD8E4C92ECA6D2D752B325634AC82FD2E52B26E1E854DD0041FD12EFC356ADD34329109E320D2F1341DED61E6A28A5876116A598FEB6F890A89EF978AEAD904F5A534BF610FDAB6C97575BC5683E3B949C9FE4B25D3D9F35048A4F2A03B1A3209A010A0C9612EB3BD35AAF7A45B3A60B6A363DA1BF49E1E08977EE2939CC0214307BFC9709BFA6E16B0BC1F9977B2510909EB111DFFD8B69566B9AF7E444986BA31EB66497AE7BD413441E77428C5279376AC898677E6467FBAE0588ADC8A51504EA281659DC3689E37D35927CD8B823516E7B0F18BCB149FCB1926CF8B50C2550444D443A64F3F3EBB4369642BCE1BC85D6A0E9E070EE0BC2A4885FF762E153414931F5C8A521708853BA3FAD7DD71E659DB78C601A0C8B42FC4D32329C01F172733A28EC505F0FA23292E0AC1297A6ACDAD20053177374FF87E09F2ADB797FC36BEDFDACC05ED5A95FEC8ED8568244E4C0278128DCE2391E9D0F0BD0A2B2EB55F533D2274BD8DC1FA6251C89F88BF03D80F5C58F3EA54B551D516322C6B10CE421B24637F571040DDBFC21AB6383D602CE7F70D2624A50CCAEBDB0F5BB949277D1A1FF9FCED2EB1D681C8268F37E1FE7114064CF6BF59DC48C74F9A3F3CB4B080A0C0FB78429C1088BDFE926DF8F19E1818EACAEBB9D66FFBB40F82D079AC52486C9E9606F2168ABF097EEBA5E4DEB0B02E1A17FBCF2ECD76408E88AF4A9AD6577E4CC1CEA564EC34DE2BC7C774A2289A21986F0786D308F295580EEE5744AD85A6575A832A1B0E9466BB9BBAC2497BC907DC75CC538E231C3562E6C8733D69769FA07311FFF047C6D2ABD21A72C35256D35D0A69B1B4EEA55A18018BE7320BAA928B8FBBF34D44E5CCCDF6764C0C8AD8FA620D64BC50B60383EF809C92B6101870FC8B8AAD51D819F6E1FFD5EF3EA3D41C41923BF34B85B14D75838052A600A40CDA2270A75298A0870A63084A646C02978A3F88A2DA723C8B0C327F66E4C012FDCF55F3E4CEAE55834FB62F3D9A25A755C43A64CFBC6553336DA1C32345091540E5EE55A67A5A96F623EFC345DCDDDFF712D27B7EF6034904E8D881DF4782A8438E7FBDF6616FC1F943AF6A1AD53202FC515BFD7A5554A9992F4911313CA3AE1BB76326A44C49D6DC3205E24D15CE701A0434EF846F14297347537859E5E8BDC8307FE4A53AB9254B1958AB9B8B7B76F86E60BB05271100C94FD548BB20FB9EA51B71DA863B5406F661805B6E79DFB9A5AC75A25FB087B7D4D8B8B5D273E253BA223F938CDB68FB657FD8CC676C77CDE203317F0BFB5FA669A3B384154E6AE1E674C390B0C0D8CC43CD075C84524BA6E83978B9C6A81A5639F9E5D9FCD96784A7979D30EE6C99371A2540958D7934DB71FEE6430AD1FD78E6AF28E26D5A9911EDD16AD01E0F0A564819013E1C6EF28BA48F1A12D263BC87E8EF5376A70DA855DF9A760A07749D4205C83DB12B20894331A1DA0618F57017E6C5A8A38BEB18D9A13D56AF139BB0423F95C5E6B61E93BB607D6699B56C995E8536E127F514F36DAEC22A37EE87FEF4E928EDCB9587D42C6BCA1C07E15896D4052F9E1ECD63B98C82811C90293F9896F2806A20B3D53BAD0380F168C6E1D13F5C0412BBCFDDA96DCA5C55D6A2E028E520D8AE7B39F0E2C17171A4F79549E467FECAE01FA31B147306E2B132D96191DF3C84EA2A0E6FC5FE86AA090BC540DE07B12D70C4EBDF7022F5287E44FE405DFA41029B15681EB29F44EC8B14EAB29F1B01572688D861CA1B83FA822BCBF425D55D19CB60040940AAD45FAD0AFE36D9D3785908827DC0258BAAD4D6458F266B5149C1E72D4CC250E573BDF77DDC40DB39653CA970A3A843FB3871AD3FF18C5A36B4CC94F3E8EB6AA66FAF37234794380EF196CE0657A3524A4C89465CF75F4FB15B5A94ECF8D152480B244800E90E8FF8EBEA91ADB146F5E2CD021C0A129885C4D86269CF335092C5188FED957CD9EEF11FEC25326433BFA153881267069B26B6A173267CF0A1F6382BE2C3F56C61F8545E04B366A66B10093F69321C2E0451DD7574A41803E94636DDD662E5DD9E3CBD1E1AE69EABD9F0C630F380F5279C0E4F6D808C9B109C221E897EEAEC2CB0AD446533CEDECE791D35C9C1C785448B3AB9D0CB72169818674AE3F17C85ED390A4235A713FEB0793C1B68E2667153BAACB4068BF101386A740CB6A954642616BDDBF919785F1E222649719F38BAFB5A0DB3539D25C5C03CE7FBC673A6111FC7192EBB51E179D00711FA95A47FFBB0BA4B68036734EB6AC1D9DD7EDAD901C2074580A4A00A290F2180C235EB1D48F878B441B015F17801E38A36B288619E1B7CD88B7314F607B3A84DA3A438DB188D154067D471D8E27F98C1BD024445E0A8FA60D9793929DEB75DD10856E12FE95D4423708FD1D4E7CD1190389B334E89FDE52730D3A5805B82AF423BC3AA17CC2B5F81BE5E42EA7AC9B3242A586B9BA84C0B6047F1F443A535EC0C6B8B10F133A1160EB70F478124FECC2DB77716D70D28A9BFD2F8CB1CA4CFC4C1C7355B169E13F5475D8FC47D87E5CF4259255F9ADB62FC195764CD461D7F4D934ACE59A8BEA40D8E1074276F93C6F2E1892A91C656A2BFE23496439D7F5FB5D765B3F066179F27E27411B36119D3C624BE4CA45B700A340EC387F40A50CEE6A001F1A59A5B26C5A0952644E4CB174421D62BFA32577F9109E094F4F57687653FC07FCAD3F99F5F3B643E1E931DD050AB4D42DF26B1BEE4FAAD9971FCC06A338D6D1863B9F82FE1E68AE7C45563142DF650916C87A6427BA7A3B5856666309330264FB9CB46CD9B8A58DA65BEAFC7CEABDDEA11910C5AE12D423AA687F500A5EB8D0A66E915864B8E67B30A0B5A2F7BFE8DF1837200AAE6BFA2D39410877B465C3F629B2C535DBAE9DFAD781501685473200BFFCE204F4E6C59FE71E977C838465D1FE995435D8C254C01A718C5FA9DA5890207EC377DC597B02FBCF3A263EF8ECD304B88B0CA235F2C77C33DF8209F42C0F6988898FD4D77F522D2A8354CCF0ED5684E11F81DF78CDB02816594255B9C60735EB013D1E92B6D06E171397A9050777CE96795F10ED11B48036B8E0241FD38F05E9E353869C0A5CB6361203B4D82E8450434278C114C644C68EC7C93B20FE7E2E50E29AC03E0832C1C77D132195DBDB739A22851B11AC3D5B2389AC3DAA791EA04CD7543FDA8DD0450002CAF580B993090B479D4B7CAADB9305A5F7B1C18287D1243FD45608F1EF5FF1257D6760835C57A24EE3F825EB64861BF5F9B34E8F8095AFB32037351C4F1DBDEE7025F296110DAFF8F67F01483EBAC6719D878EE43E6562E1C3D848031960734568911BE64848E7B2294297003A77503FD2CF80335A631CE4B4C55C46D84A509A7ACC7E50D452915E2E9A30C45446CF05463BA64DACA036F27F629A13F30D21800BFE51719F6BC280DD1730649F0309E6D3556319B7D17CED56E86D3BA2AC6DD98AA11A80FD38B73148908B1F9423493D5928F3EDAA8EF878BC88ACE02410A204B370609CC196503A1DD547C9CE1280722E7B214B21CA6C9DAF981AF9B63E08CFDD7B5D0A2975B6D24CCFEFA5E02B974E106D8E93694045D3947D2020674745B445817067B82626C4CE763BE68DCC2782534D5A77273A279E489679295C45C2C77100A5EFEB5481F500E12720490107C129246770E824308E982D1A355117D0C3FE6E0DDB422F5C4014E36EBE77A2CF6FDBE9C3D05C106D3E6CB707B7B6D1492ACF66E069D9F73FA6F8928DB83D59796AA368576C165B98C766166CBE7612F27650530D3D0D117906DFED34787A08EC4E8A7DA97BFA2625F163879715DF121C17127331930D3BBEB894B41E8FC1F921EDB21BFE63217E9093EA2D37C2AAF85284547B0861C824A8875437BE122F636E077E67AAE13047AB240F332A0AEA81D722D37CF91E120CD92594AA37D3ACFEDFC2FB174E9A38BD9520366CF39E789494B24C82F9A8377D0B1AD08882AA1DA3DAFBEC400B1A57D176D33686F421788445F0775BA9648D943D28809ABA417EE0BCA0584801F58857747599A7F5FC74C8B575C31DEF62E6FE046E1FA220330A6F8E9C7A153403CD296519F464A2D65499196695CC54C5090E1CD807528FA45746F9D721F411E2610C70A8363244E0A354DB72E299A8004B6D13638332FE3621AFDCC23601338A5C69A9CC1884A192AA74005BA63FDF3B698B70D81CD0F76BF9C9AA76B79ECADC154CBBBDA10C9B270665E64784E46AEDACA3E46CF5BDEA3919241E209C606ED184E7780FC29FEAE83C1A500EACFFECE76C111C0D8643FB37DD045EE06EA5D516384E6F5A5A9BD16ED64FB180F466E83B085A5961A424E158866A2B4D048FDA5F7CEB2C6A5C8F58791D62463AAC59797489C3146B04295A568AFD3D72256B0D30439DCC9E120B84BF048552E37BA7F414747A39BFBB6710CD1A6FDC97983CF5A1DE85C502AECE0E01373E91E5B283544C740FE7E5D983B9491133D4BD95CC320F7D1F36AB2F665D86C38F7D49916F3F229CF7A07D65BB4C35ED22C0E853D796A3C3B778529605FEEA93C5E3FBF7A984F496F17BBE55D41C824CC445A8094F5BCD2E88A7382155CCA89EECABCD237CB00563172C0C64A303CA5D21B962E1593A48D313F272FFB3104DC40A23E1FF8839CAC278F989583D3054CFDEC65D68FEB984EFC1D4AE3C11BB12F60EB96B98B5568B1D88C4E8AE5A9EA4AA1B25E54D963D73855EEC324DDD873C488006A3C2E0B3D28DA0493E1DAF1C1CC3C58D3D8A209F18DB719DCD5DA355FD8CE70BCAB5108F9E5DD7D55F9346D77F13695F51B3500DD72E012F2D39DF224CF4A0032965A55DBB21BA8422E2703BCA4221D97A42268CBEF7E7C5E968B03D362DD1355DF70D34513C4F3C6DE7783A014481FF68B62B50FF07C970DBA0D5E2D6F66C98EBF3040FE4B4290A78C4AF642D705EE80C525F5BDF88DEEFCAEF54C6EDEDC6182179A510EDEEE625F431F36D0F4606B5C9BC8F5D38A2069BA8F3730F65BFAB7919083A63D6538FC477AD838531732A36378AEFB4FAA5550283CD537B52A9C98E45E426B8631F9509304BA773E8C5DD9262D908C38BF41E082B52AD06944EBC184E18190BEBC3E6EBB18CF00DC36F5C098BC70D806E63BC8298194FCF54500371B49B6650741A01ED6C05F514BC81E4418EC2E7A14DFFF0E8394E3B96A08927CF92916FDB3071E5F356862C7F15EC3F5C83B1BF599AED478903D77C88A52709E649752099DE4344B9FCFD480E1AEF95A116E7CD7A8DA3DEA6868C5E3E1B8718E05E87B90FE125ECCC0662CF90D7842C0048083FBC975A96806D12482F5E6270D421E5D0A0EBFCF1515EC2C82CCC6CC2E542BF8EABBF5317421C2CFF56B2AF75CC4AC767871E17202E2FA8091844393E35F44BD36C3B41D009B73DC7E0C67E78D4D11A9BE016BE1D51F27EF6EB76B6A8AD1AE81426230FBAC4E0060C5E4DD9FD21DB692A0DB00254E8C7C1888C24EE66AA946CFC30BFF411D9A4D8282A8E47BA5DAB37DD7E969A394B4F63CCFEFA1243688C43173121A2C134CC35C2A622C805ABCF1F28FE842CED6BB86C587F1160EA46BD8566294242C6508CB23C879A37CEDA76F47DB3E64C40A9E9D14C742706E07520D62D24E6CC67111A6806B4C22CC0705CDB9C24AD948419CED06F49E31CCABE7CFA36EB67260A95B863E62F816F9A3F76888334CAE1AB333077DEB427DF1F793B533582F9D60DCF0296043359EF5528E30FF552178EC1DF5B4CB0FEE03C9F02A44EDCDCD5925689354B9E9D440EA4A3B7B88EE92233317AE8CB055DB17CF7ACACB8B1761B44D767844DB8E61C309CC298E9B998B744AC389694C4F6EF44ACA629B675AEF7D52F90AE8B0AB522DFAA499AD4FD80C190CD35AEA13D8DC23575E98CEDD722671DB3DC5F622DA239A448DBDDEC26A8ED194049D9CD1F2118406A33A6E2F2B291D9D767DDDEAA116574C196C78EFD8A17C8CE4F56E6DC0C6A9E2107EDCC18F8E4565196B29B08B93EBAF5EB8B964D5D0BD456FF7FAFDEB716E726DDF1DA3F07E466BF281744BF1DF84E32584C598A53D8B5FA555795E40C5F7A3C5668E90B059B7E18194E5BF89B3462D469C2AC0F2D9AC21E812B35D67F61B819FC40CE511905326819E14B5194D18A16EEE9686B766467E2A76D9E9587329374BDB6C2A4FEAB4C86F3FC65FC92BC39C719FC02DDEB16EF8E996D88D56A9F7D8C75ED7294861B7E726C818745C36A65150DDFF3CB173EE0FE3CFD504DF72A8DB5C52DA882F6B0FA8F9E8C0B5323922ECB88CE67472909B2D9E49BC4605FD75E3D20DD1600826CA234CD3A6CE666B01B3975C3625D598C2DABD37BF39D18B0DA500F064BFA8A356A96F2645C00B040B973B8E591DE0A97AE7CB76D65D4A5D0ABF284E5C740FFDA8FE3E93A42676C0397A4BCAF230891365108FC92FE3A6A63E99DE5F9FD399B364284409EDCEBDC7780D79BDEF1AFAEBC15E02E4FB838C097EC1E5DBCCF129C130F50C90FEFC75232AEC99D603AC0287A7424B93A1E01A2AF9B472FD1E9B4CA4CFA6845A14FBF36F1CBC36F8222FE3C5DE0D8D023D03336FF4E0B8650344095C5D0C09DAF2F").unwrap();

        // Fetch the signature length from the first 4 bytes of the sm
        let smlen = u32::from_le_bytes([sm[0], sm[1], sm[2], sm[3]]);
        // Fetch the message from the sm after the smlen and to the message length
        let sig_message = &sm[4_usize..message.len() + 4];
        assert_eq!(message, sig_message);

        let signature_to_parse = sm[4 + message.len()..].to_vec();
        let parsed_signature = Signature::parse(signature_to_parse, &message);

        let mut serialised = parsed_signature.serialise();

        // Prepend the length and then the message to the serialised signature
        serialised.splice(0..0, smlen.to_le_bytes().to_vec());
        serialised.splice(4..4, message.to_vec());
        assert_eq!(sm, serialised.as_slice());
    }
}
