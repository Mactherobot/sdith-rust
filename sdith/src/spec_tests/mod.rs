mod constants;
mod keygen;
mod utils;
mod witness;
mod xof;

use crate::{
    constants::{params::PARAM_SEED_SIZE, types::Seed},
    keygen::{PublicKey, SecretKey},
};

pub(self) const SPEC_MASTER_SEED: Seed = [
    124, 153, 53, 160, 176, 118, 148, 170, 12, 109, 16, 228, 219, 107, 26, 221,
];

struct TestVectorResponse {
    count: usize,
    seed: Seed,
    mlen: usize,
    msg: Vec<u8>,
    pk: PublicKey,
    sk: SecretKey,
    sm: Vec<u8>,
    smlen: usize,
}

fn seed_from_hex(hex: &str) -> Seed {
    hex::decode(hex).unwrap()[..PARAM_SEED_SIZE]
        .try_into()
        .unwrap()
}

fn get_value_from_line(line: &str) -> &str {
    line.split(" = ").collect::<Vec<&str>>()[1]
}

// Example from the file
//# sdith_threshold_cat1_gf256
//
//count = 0
//seed = 061550234D158C5EC95595FE04EF7A25767F2E24CC2BC479D09D86DC9ABCFDE7056A8C266F9EF97ED08541DBD2E1FFA1
//mlen = 33
//msg = D81C4D8D734FCBFBEADE3D3F8A039FAA2A2C9957E835AD55B22E75BF57BB556AC8
//pk = 00C2F93C1571EA14C079BE797D534DB12878B89BCF4CD84....
//sk = 00C2F93C1571EA14C079BE797D534DB12878B89BCF4CD84....
//smlen = 9981
//sm = D8260000D81C4D8D734FCBFBEADE3D3F8A039FAA....
//
//count = 1

/// Read the files generated by the specification library, PQCsignKAT_404.req and PQCsignKAT_404.rsp
fn read_response_test_vectors(n: usize) -> Vec<TestVectorResponse> {
    let rsp_file = include_str!("PQCsignKAT_432.rsp");
    let mut rsp_lines = rsp_file.lines();
    rsp_lines.next(); // Skip the first line -> # sdith_threshold_cat1_gf256

    let mut test_vectors = Vec::new();
    let mut read_vectors = 0;

    while read_vectors < n {
        rsp_lines.next(); // Skip empty line
        let count: usize = get_value_from_line(rsp_lines.next().unwrap())
            .parse()
            .unwrap();
        let seed = seed_from_hex(&get_value_from_line(rsp_lines.next().unwrap()));
        let mlen: usize = get_value_from_line(rsp_lines.next().unwrap())
            .parse()
            .unwrap();

        let msg = hex::decode(get_value_from_line(rsp_lines.next().unwrap())).unwrap();
        let pk = PublicKey::parse_from_hex(&get_value_from_line(rsp_lines.next().unwrap()));
        let sk = SecretKey::parse_from_hex(&get_value_from_line(rsp_lines.next().unwrap()));
        let smlen: usize = get_value_from_line(rsp_lines.next().unwrap())
            .parse()
            .unwrap();
        let sm = hex::decode(get_value_from_line(rsp_lines.next().unwrap())).unwrap();

        test_vectors.push(TestVectorResponse {
            count,
            seed,
            mlen,
            msg,
            pk,
            sk,
            sm,
            smlen,
        });
        read_vectors += 1;
    }

    test_vectors
}

#[cfg(test)]
mod spec_tests {
    use super::*;

    #[test]
    fn test_read_test_vectors() {
        let v = read_response_test_vectors(2);
        assert_eq!(v.len(), 2);
        assert!(v[0].count == 0);
        assert_eq!(
            v[0].seed,
            seed_from_hex("061550234D158C5EC95595FE04EF7A25767F2E24CC2BC479D09D86DC9ABCFDE7")
        );
        assert!(v[0].mlen == 33);
        assert_eq!(
            hex::encode(&v[0].msg).to_uppercase(),
            "D81C4D8D734FCBFBEADE3D3F8A039FAA2A2C9957E835AD55B22E75BF57BB556AC8"
        );
        assert_eq!(v[0].pk.to_hex().to_uppercase(), "06A80E69AA864FD9A8ED24508E7CD2955EC7B8C297C5BD6023D8F2E5204625CEDD59E16AC667D78F52259B1636E5D6E60FE9E3EB2110D7C6070354EB1BE9A07D6E5F5EF1F4A418A92E81016BDA7B913A5C07D92512D1F10C72EE104B36D1A99271CF02D643C26452ED5B7C6112A89DB6926313BB755B31DC7E55A8FEE48705430189D3ED");
        assert_eq!(v[0].sk.to_hex().to_uppercase(),"06A80E69AA864FD9A8ED24508E7CD2955EC7B8C297C5BD6023D8F2E5204625CEDD59E16AC667D78F52259B1636E5D6E60FE9E3EB2110D7C6070354EB1BE9A07D6E5F5EF1F4A418A92E81016BDA7B913A5C07D92512D1F10C72EE104B36D1A99271CF02D643C26452ED5B7C6112A89DB6926313BB755B31DC7E55A8FEE48705430189D3ED5B35D9CA7E039541927B8AE86AC9BF19F3F1D198D3E7B95AAFFB7A2A6E38014B38E0FD8AFC9AB921D1190935137A88EFB6CC624D743D341E85E619B479B41376AF9F0EF69504A322C08F495055A9F1284DEEC5EDE189862C183075C994999F7F7E8BE1610AE47BC460F0319D53DA1E6E7287F431002BFC6E22926F20419700BBC5B820CE392A20253B2549B30F2B69E4BF4EB39AE10E9E32472B2F9C88D63B27FE3B3E93EE43DAAAB17576B3D28A5A2BBCD632C3906111B27E50A8C1790557FC406BC86D5324B6CEDC3959797F3630F4FACD448E81153BDCE55D5D8E9C486C0E9AEDF4ECE7C1F1CD24FF3A5997FADDF7DDCA74649E5832381305B9DF2B79C03AA0B4E1C1CEB13F0A7F695787D247C8678DC96FFB421A34E822F6FACE21520E20E4CC0BB0CCCB5DF2414A68F1");
        assert_eq!(hex::encode(&v[0].sm).to_uppercase(), "18280000D81C4D8D734FCBFBEADE3D3F8A039FAA2A2C9957E835AD55B22E75BF57BB556AC891282214654CB55E7C2CACD53919604D5BAC7B23EEF4B315FEEF5E7D0BB01D75D31A0CAE310989D7A5B5DD8AA3964CECF38DFF12FC9BFB171076AA1375614533B931C7770471CF4FE72ADA410515097FEE1244B9E7FCCF31C5348B52CF7548B57AA41CB1A8C48EC76BA3C65B363006718A5255D17FC6B0C610BDF15B44DD53B36CCB7CEC17D049D1E90F42CD60A80E205736FB42DAB432BBF336E2EB70EF8EDDEEDC1FD859AF8B2CC1A793F50F61DCEDA5BE7CF8CEBBEE915B4BF94F8E07563A3A2E7511D33369366004B3507F08E5842A647851048FD7D6BC557943421F5C46282AA26839198BA67F7E8B44F26DE00D070CD9E13CB39E96AAB38ADED6CD2503DBCE26E44A61997D967BDEB4C40E15E09C0911FB493CAA56E99E6CD8D3DF4A33A5EAF524AA0E7359464979A078D99CB03AA75A4B74F9BB2038A358CB974732FDCFD61E5B97DEFBA4B232A0068DD76DD73A521702116020D278B30F8C7248A798DFFCAA5EDA5193A9AEFE92D42D52DB9088F6DEECF7624F6C310AA3F1B41A0C65B75D92315A6DB7835EAB4E95E436ED2F08CA181E75A585703B505F249B838B8DEC7E32420E24C828ACDBB56E8A41001CCC57EDC3282DEC2B800D6D48DB0F185FC5762ACD3509EB9A91F8D03A02E9FB36008FEC93A60B0C1B63186D972B79566126759605D009E72C6AD238E17E863F1AC1AAE50103EC4BCB4C26E5E1895B461D648453ADD92AF884E15FF885E5C88B496C0110EA10F67B3A693A48042A8CBAA95BBE6DEB11C2D421EDF56859CBF568526065F73AA6B242C9EE3D05F1EE11BF3AE4C68739541510B9137FE8E498001391E9C6820B26CC530B3D2291DE58361DEF061C9CCF3D30D0D7F8903C361C1726CFE6EED37603AD9BEB64E2283E970A19A3A5ADD998A904C584291C4973F182BF388F21CDD81BE768BB0811CF72EBFBCDF5F007B1C7F3BA7F9F1885A080813A119E45B5BC0373C3398EDB3B4209D406333609114EF46CCE6120A553E967C8349556B65C78E1A1552A4C1099B124C6B7C43BD734FAADDAFAE2E9F5E7450EF1E382C6CE97BA1DDCD00E47EA69D8B4C58B50C6717B9CA31E34FB549A0CB19119AEA8F36B7AC42B58255B7CB6E91840B575DC1F311A393AAE349B8BC25F0362B5A700B3007AD7B8E8D990A14C77BB0711FF681930E5F2EEDE3D322EA13DEB9769B395111FDA85AC2D0192BF0A3CF3B1DEFB6AB50FAD172E4F66D14D9489CC9DC43B48EA2BF030443BDF45044A4303EFD8E7BF077E92DE806B722EC856A98D06FE8F04D34690A9ED24A81C9CF316F0BF6DD6251B0EB4E1FBF128573CCCBF5B027243C368B655E06B8511CE749B798F064796DF55C91102505B704727B998E080EBCF5CE30300F6FEF5CDD8956B30B5332412AF449025AAC42B7A46C6E78DC79BC6B728A53B401B4F4CAB6FE382703DBEC8FAEAECB4F8DB2C631334A9C342DA3D4C44CC637406BF177D5784C6D1C466A80B29193710E3896A4F463AEB1920A8BAC998323E7840DDA693C30CFED1EAEC448778321298A4C5AD96B9CA26C1EA7A5FB575025E54AC8AAB1C9EA4EB2461F2231EC700B6A772EBB1603A264DAF122AEABF07ED6E220E0A89E90188756BEAA3D900CECDBBCE24464611F4D792BC8B16292EFFBAB5A9277C226007C5587EAEF7B56658E7ADFC607A98A654230D43371FCF995F7CB619DA33AEF0BCB7878C645D190F990196EA04BAE776C5594B2DDEE63913453927CDE1BF28982777E65A1B4E699AD004D229630818E7DA879B8EC309913405D0F732D9B8DDDE33C54FDC9F9E5EB2F8FF7AA058ED2E5A666C4F1DB318CCB413FF803EA0AA3A1109ECF5559FEAE73C6EFE4A7257BC18FC981D1DCD06B2E87381E53B248E37F7007F0E5D8E0B4CBEA40ABA3AC2D8011A360D3B41DCE71D255330B0BDDC925685E901F141BD8F77A2C76EF3095FD3A26B60BBEB9F7B8BA438987952D989925B75DD4496E4A8A49775EE7494AC7AE2B932D10F0ECF3396D8C0B269DC6BD669E7DA19DC1E0D828A8B1409A0BD2D2C3ACA9D0C81393D67914490A584E1CB2EEDEE6EC440BFF590F4DD6D3B3D0AB7B57F73B06E139613A8F05FDD496C48C9C1A590A25B2C4D82A56B6B72A0FC6B344CFF5D46A7447D8217472397659495689AE6CFEED76153886AADB660BDE4A3BA66E6BE86F0C785D6BCB2B42FDC32516E9B8167A33071EC09931AB6F89AC926EED0F72FF2169D04A26C3D575920C11D892DA3100FA10F2E4F2C6C504A0A43D82F1F0FECBC7DD2483A6F56AC838147CDE5A7C0DE8F957B56C030428BDB79386254110F22E53DEA98EFDCFB155F64DE6A2FDB4F84A8081D2B31C5FB53214B633290824841BA7DCC47EC455E5355938820F8A055AD75BAA57D698B2563EDF1DB94CE14FC13334AF2CCA9393F4CB75801297F55997844FF9111E7B44D459DDBCDDE9A5C28E252CF5567593064C52638BF54B64ECD07F0C64DBFCE6DBB663A9E2B159D53FFCFDBB433E3618CF828871DB57BA4E936A6685CA43E919854CED0D63BD6507CD3CEA08E08CC4547626650CFFAC23DAA238C9CACA9F46C633408EDA851B5F9835D91C53E557159F914715F50056CD8B9BE73C4B35678A428FBBF65B48ACCE98DAA6FCA500ECB4BCBFCFC098D77AD9826213DA096CA76BB0B0D67AA658FCF405E8490299A0783C8994B1582596B14275858FE7B62A5D435FD533098F61317C7DD578499416EA9AF38EB048E37A8E5D75D2EEAEBEA3FF9B2DAA87273799CB0878155FB03EAB198C004F61E237B10AA040480EAA591D42D481F6B0D30159DB099824068D582BA503C552A1765E2FFE42481A9345EBF75BB04CC462A9B39F765F4F3AA0F1337B5F0E11BBF5DCDF32AD9E890426B60A71FE2783CA14F0248EF14086EE3B692070FADC279689E15D68939B5FA53CDF9D5FCB7513D567DDDB3B6BD3DA41B06318BA4C40E0816CAB35C15C9AC43E4976250D28EB5F77B99ED19FF62A6453A3A3643EF45F053C852E53CF87D113C605BC885ACFDE7061EED2CA2829E8272650003273767467527440A6EBCEF00FDA4D4FFEC83E0E05C501C88BF1C9A5F95BEB56EA1BD71B7D224AAC2D7FF961FD9581ED86B2884516F8BFF04CB83E9A23BBA6A750818B105216DE337C022928FF8E5809A61AA2787D1B6DCB93C33787833BA6A6F64E2CE288F31DCCC5ADB0C611CA11401900B8E521F835A81637ADAE6B72732ED96B10C7F89094629C54FDCAF926E95B5CDCCCED3A2024F9EAFA1E54F4C1352A5E197FB518850A55FB54A00C8B9E7BAF8E81D5E0D2E9E0A80EF3C33402C2BB9BC0F304BB6A494F7D3FDE32F29FA176095DC04814EA9DFED12335AD09C9119C2D122B01F6DFBDA1989EE40756CB0340C0DF6E72EFC2E5077D41B73E96A13F5E768F03D0DFCE968CD11EE33FC2A5B4F8DE98DB72E00D2E2DC324234BE851BA9838F7E4B1BFFA490B24730A5FD19B0709C13A51CDB81C19E6563C0A800C642591E4D0627882CC1B4E26C02AAB0874C54427FDAC3F8806C8328C4D97F0AC1521AFF752674BFA0FFB21D956D19028C4EADCAC820E316E084D0CABE8EEEED46C03FC96065BB62CA795BAF2489813CE6359B1EAE07634E50F1BD102F5413A4F63B0937B49B08D2F5A78BB245C09114523FA698DD7BF89875ED1D940D01691928ED764F52A326D930FAC447F1F2938D81BF9B2B82A7538EF0855211A231BA1FE0CDF32B2EA35B7D61D4E162279546C54DE5652876DC45790092820FF26AD0F814D748C625E62812D4EF4260BB3D86E1977FF7E7EE5E98070CBCD1D22D646DE98F1AD1EB239703EBD4EEFC5FFF727A4910CC7E7D588D622C66E2BE014347FF286D6B96C8B025CCC01FA42327DDA2DC48ADE96A447E9B710A00114AB88C93B1C1FEE83A17460BA30A3E0D54CE4A01D805ABD4B0359862F853BA7B4A8A650DCA0E1169BD99F0376DA3D97A16E16CE905D826E2F2E54B6FC89B8F8B87F45375EB8F63B33210A1B11EC52A4D4F99480ACB712E2CAE004A550EE1EA2A54D3D6CDBB0E1C8CF78A61C153F65B0E0C00080B73D536198A988782B3D0F2E234F844662461956930AAE7E67A8D742A6434855E935B6E732BDB25A29128A1F7C210DEDA388429329FB294030C7ADD5BE9A5E1D9FBEB7E9B6642611537B397D11B89B7839FD6B86AE43BC8044A2DC68855089E0946F209C3857B45D35554FFE676477F3C93AA27B313F8488E65139F1D18740AD5FCC97947B766FBCA843B6A01ECAD121358FF6D3265AFA3298DA511C072D7A0949E3C3D8973C558C27AF21356EEB6403841B3E4F304E16803EBEEC296DDE95F8E50A8710AD53ADCF293E1265F05524151D17533CB294B90FF1AFF81774A1CB63AC0EB7A535CB414BD7B7A84B7B68093EC34AB4DC075DB3A85278BEB6061A6877201409CAD0F1155E2C0E0AA15ADAED5DA33F42B89D179F1ADFD640FB0924C4407DD27D6F2A4603A2FDB1F16B523B613390A6C99B99BAA214D43C27EFEEB5405E67E063C350F58B3627540A3FE4A3A66DDDEC18D345C6566E218B04059F07227A9A83CF05966542DC8931AD6AC07F145BC66A86B44D3F5517B18078F187BE4E99C9A83C8A5619E27E78DDD54F8C92173826F49E280DECF9B348C3C855DC79EBC15C66A2A8363C35C4FDFEA834C43EED300869E61D24BA9504F9E5BA0F9712E6F552D48BDF72679D776D313530828811A999C93720732C25D2F39FA630E1B681A6281B961544A56CC77C3C6A597B474BC006B08298B3E5AB2CE809B890FAE279942E86A639B9EFD153F0464B99B2EE5713223AE911C91B147DAC848C1AAD3D0C76A3AA4F2C4F148FC6E13C5C056C62FC9EE1218117CDA7794E5E91BAF16A65A7450143CAFE66CBB67347DDEDE145529C7A412783EF4879D731459C956284F57CA0170E5998A7AB5F8FD843142D5E34A5E0B4109A31D8919EC6C019D01D66E44A05B0B628462B2DCF0168CE4BB411CB52A2B40C245B346A7773E5F90F797201FB4B8B248B5C7F98A9BCF010C6F2BEA2D8B0FD6F3EEB8120C246AA7E002A40F36B4D11F5A5119FA399CC04E83448DE3EEDFBD74E26D9455E6D3748FDBE66694826E7583F7C5107AB3529AE905084EEB770A53FA8E9718C7E281C40B0C6345EC56958F6417D1F2628254A265790B390050E1A45B1320F9DBF2778253458F72B89F436A2E53C0E60221864E2662BA50B816B6F1C13B52F6C17E87D0CF777BA5142429614EE03FEF9C790F80B035BDED33465B48E22773333C646442571B27F81C3661A6BFEBD57E72D0EB028F2A7C8087338459E25EDAE58E4F06BA9AC9338C245356D66F2812176B0B65ECA4EE5FF67FD3ED8462B957B9B3843F3D8093BDF00361B7E4230348D6B9097E325D17123BAB1FBD103E4034A62D48BD8D033B18EFD0F000477A55B6B6EA61D2B068328E26D97311CE78D951B57577BE7E20A168CF523D431D8A86BD309DBFC05CCEFD71F2B3A8779D17E916C303B03DC3A9057953F1FB41EE3C76814E76AA2BD90E3D884DFEAD22A9C11E95E014503373F044201C13EA062CD2BF9BCAF561BA1B1E1F08D9E6522EA25110A6531F570DE8B76E68F41F228D0FF77005832D4FDC2B34220E9694E50B8C130A3959E765E1BC5610F74D1D5301AB4D549DFD705314C85A533047FD4FBA4304B828926CD7D78178BDEB6E08DC02EF994A3C7E98C8A506C6B45DC61515354EDB067968B1E66299878E8EAFEEB03B85D21866F8DD1957E70D0488889AC39B8F5A897B423112A239D88BB172500C1352DCA6E8D278D738D6AC496A488C16A1DD5966DFD1B45E10C7DA1FA5E55D3BF644352FB98058FC2005850869600213B1D1692301B58832B09274BEEAE1E2DE28CAF0B86FCAF6EFB1DDCDB0680041C957BBE64019C99995AB6B55757FBC97A2E910206E1B95B86AA9FC4C8CA7BF75C4F65275560146937D62FF9DFECB9A151125705EBA49FF2FB541358F98D5695BD6E29C0B2F6BBEB44886106A3D7A9E4D44C2B5794D2C731A1B41077C39EB18BE8E7436A6016D898E186649FA9DB0C597BF902FDBB5D61204FB784934D2D851A5323527AB1FE39AA690969B4D0E6EC85DF7FAE3372EFB437A379D1651304DF50D8F60473D4753D58A0BB64B2323B08E78407330BF11D88FF6B97EE49E611E679D8A8003B4E5F5DD4B8E1E7882D98318B03DC6580F822A05367A7691A938E233C78523AD57BE115DC0C677EEE9A0FF5D530DD3B6159C1EB654373912A56FC5AAEFB5DD2044FDCB960B6F12B76DB89A96A072431CF3D837DBD5964A86668F6FAFAB7B161F00A09D1665C361BE8B70DD0BB09F366BC903142259A32ED9892E3DFE07F12C475A4703D5353DED55F78C7F72CF6F1B86CD43DBA383EE288CE372E237AB75F4E0F07CB548918FD000083F0C25FB0F0A371DF93742DCE7033999568E0ED2D5DE85ADE95AC7D402D5795FF56348CAA992AE753EF79355E6AF3BD59A0F3507E70B4ED10B86918A453A13592DC118E77B7E7393926860B5FE4AC73E7E760B43D5DC815057C58EE2E206308FFF0558236F952A3E17FD8E5E5CE4B779A103E9D931B02DA7C0E50B2DEEDBB054A2AC3827DA16595A49FAEEE4A62B2BB838F3BFA91A831171E3ADBC458940305D811D8F2D6494678B1056EE9D60E6EE1F2A893E1A75ADF616102BB56E3F23725786787383821798DCB6ED6A167F95A4E6D3CF0BB1E190BB199A17371B519BAE7DFC3AC18DAA14DFC67276A545FE606BAD23EAD92300ED644FCBADC3A4C0C7C9E2563BD4874EA268561ACE9D76B6CD8F6C963A1DE66CE75DAD961DE4F0AD7899BE3B36C701B6A8DB81DAC2CCD4110D6ABC8557CA39F94791D2E52D6B234078E161E0191EAFCA0FB5CE298D33D40F46828E510BE8616CCD4CF5B40EA9D3646FA4585AB22E260B763F766E3EA87A24D6499AB06D5A0F95A179171B058B33F3C108C1ABBAE3A9B9C76DD161259DD923E3D009C4362EBBFCFB8072F4CA7896FC1EEA496F1B22F1C3D4FB2357125F948387DE8C45C6D3EBB2EA88A836D19962A772E464298847188188A164BDCE9B35A84AE98844642990AFDD92D95CB35B211A368F5FB24EA099C64862A4C98AE4C00B530B395DCFC06583B2F2453DF2375F78249ACE0ABBDD07E189F372FE030C55865C1661B29ABE1B522B06530E581AAAFA429F3667232FB562EEDF023F30A3FA6453199B39A24C66C29138037FED40B205ABCCD03B1DAEE2D007F20522E20BA4158FEDB9829929BB91242F85D7021E959A17AB4E160CFCA1CEEC4FA59FC5B0D5065C845D1AAF62E7D89C5E28807A17D7AB1FB1194C94C93BE36FDDCF223ACE4AD631D11B64B8CF768BB1FA9842A36E5590E98EFDD6ACE690A0E64B313EF017C4E2902C26DF87AF736A40A66184DD16B8D4D2FA04AA0DE995C8327F0427BFDFF90869F23901D2CC92D675C630CCA36F1D7C7772FA635B437C7DB1938190EBEC68239C2EACFC867996F65678D2EB9A617DC7F4CF1690171298929EDA237283EFB992B275EF5892CCA8EF6659B878BC6CBB93638DF39CDDF0541F87E6C1C57450A891E771E8D525E00723400ACBC864886364F4467C5E145984B34389A55B4A533CC62F3FE9AEF566183EBAFE1FEED3A4859439521428DEB6CA4B8AFE5078F4F17912EA25D1B5DD36A870EA9A03A5A8FE24F02C11F6C9580DC4A727F3F96090AFC4DA07F21866C8183AF6480163B425771BF2D5F2F0EB0B9FCDBF64C7046F93450E653C72973906B1D4E9F34486ACB837A4E13979DF46115868882D660DA8D6E25143B61D1C1C3B24BDDACC075DE2BFBA4267D47C5911A28B5754938170F62D243B7F316F23708B8DF2A114CDF221AC747269841BA69B6F97D4CC732A3179BE44FEFC463C40D31A96771198E9315F0BE97C1447CCB7DF9F18E433B356B323C9BDA8464C2D6A370A13098BEED5EFC3E14639075097B0D3773FEA285E825D987382585B1D6CC33869A9B5569D0DFE28A86F8A309851370E0B46900E2050BB3BEF730D8FD7A391BD9F183FDC6C4F221D59CEDB1FC4CEB019D67C63C9FE29B9D7EC4757D8145A2C6763266DDEF524AD440DF2A7F69CA2CBE4272ACF17989A6EE6CCFA9C29BE1B3472922D9CF3B958F90EA4C6CE43D76211441C5A25262E642E36232F455904DC78D9E5C14CFA6822531CE9054ED18A3F9D7BA2A98A2C8FFC4C5F88CA15D9690D64DB9DE5EB32D367A7A984988218A2E024C716CCBA72A0F0494E32F69A86FAD2D053F84C1EAED986E0CB091BF04FCB1789772FE94E7D08C0A8EA96BCF3D891A7349DBC232EB1E2C412853A9B84C1094D561FAD9B5F86CDC3E9B90DBE763FD166B969C80C8B42FC4D32329C01F172733A28EC505F0FA23292E0AC1297A6ACDAD20053177374FF87E09F2ADB797FC36BEDFDACC05ED5A95FEC8ED8568244E4C0278128DCE2391E9D0F0BD0A2B2EB55F533D2274BD8DC1FA68E51A97EF5166527BA12302E0C6F5792C1B842BC1401F7D3E7153623B9638549213E51C9B111376C089B2C4CDA6D0062495F4BA65227FF0ACC606793BA111EAD43766B332CBE3C78B86D96264A10C908032C4AFDCC3715FA274090E925DE76CAE466B2B3B4FF995A556EC0CB247EB99612014B22ACE63CC39BC312BB59486522C11C9B66D26149C36F7CAF3D988016CB5E5EED02F58EFCF89C49B13326F5B338C21027896B12D8675C9B8E64CFA8971229D9CED8660B8FA3739690BF382101672199E3BFC4C9B5A24E84010D9F2F5C528978B0EAC4C4477E3B2A889695DA67AE10ACF82C2B926410A37809C2686D417045253B8C8266A2A83AE0C0E3CAFA8E53331FED09D889FD58C9819CF1B9A57990345B710C911E310BCEC828702E3D59C5A39F1A30E3F41C01A922CEE334B85B14D75838052A600A40CDA2270A75298A0870A63084A646C02978A3F88A2DA723C8B0C327F66E4C012FDCF55F3E4CEAE55834FB62F3D9A25A755C43A64CFBC6553336DA1C32345091540E5EE55A67A5A96F5CCB08A3024005325B38BF9EB0DF45AEA612377E12A6DF5DACB857ABC44BD4991734089951A9861448E36105591912EFE24615EFE28E4F6F94004DB3B2D301F6F3E9F871DC80BAB5D43621C263891DF6827728B5263E638EFDE05B22DF17BB05B710D92365062AFB0D157BBEF8580EA4B5A382413740679713F7C5D2124E5A2FB2A4724A96F51C312397D6EB37CD4BB912246E911A50759928064249698187CDB84064BFA5CB661FF40BA5EE446060250693AC8375B9BC8092AC621354C68D174EF1EF72FA754D8C5F7AC33D0BB1ABA59FE8009E1403E1F1183EDF842EE08623CE3624D32ABFEAE55E55BF4F0EE43511753AA8551314797A29872C2C5438F4632B65F357829075002E60C16C6D36BE8A0C48E49B347AA1A01F55594220617E86E660208D618EA4270CFD60778F57017E6C5A8A38BEB18D9A13D56AF139BB0423F95C5E6B61E93BB607D6699B56C995E8536E127F514F36DAEC22A37EE87FEF4E928EDCB9587D42C6BCA1C07E15896D4052F9E1ECD63B98C82811C90293F9896FB12DB002C598DDD74412D4E78F34D7936261DD18426684B7AF9FAC7234CE7AC5D2EA57C5B1E6295D778617AFD8B2AF791B739A27E7E3A2A702BCF0907A71E06A0EC68226AF52E7BA286E005ACF3F0AAF3A8D9C7D191B43C439E817E04B2734059010C665493A4C5317E01F05AEC20314716F332D94FD0AC9A5D5F482E7404970B537EBC8DD29CC5D00BB472007A7A09C11919E3B0FF00D634749ADDB3152873DD85C8B5C80DE2CE04F253F319112B6B4AF8D34A43826F434BD182472A174B45599B12ECD693CE836BA3BB6C6597995C309F9F95EBFB7C526E72B61F018088AEC8997FDD5A6A6E370ECE052A2194D24BF4C5618933EC5E5C1155D66C1696CFDA04B9ECB18A929ADF1E435DDDD4FE6E7643DCE7D725D4611FA17D1EE7C4093D54D7FF18B0C85CCF60772EA0732DE0E3E459134B10A7D2652833A2619538DA665A7DD88E3B47CFC9CA8D3DC3E9585067637778258AA3BA23B4920D1243DCCEB49CFFF836BA9A75D92F575A2C1EAC61F8545E04B366A66B10093F69321C2E0451DD7574A41803E94636DDD662E5D9574CC54D91050BB8E1E14F0A9F1A2D57EE3AD9926B83433DBF20BFDCD3227E4102F8DC32EB42310680668AC63A3B9526FA70EC73BA2ED9EAA7DFF95792B0B89D390A4235A713FEB0793C1B68E2667153BAACB4068BF101386A740CB6A9546424AE2C2014D2FB4A6AFF92DD21B23AD941A4B63761321CDA704CF18FC7FF6AFB3BF1202ADAFF7B0DD74E412D866A62255332E33AF24E12831506CB562ECD7FF7D2074580A4A00A290F2180C235EB1D48F878B441B015F17801E38A36B288619E18A5F94262BE7C7C4C45C737F94EFD763DEEAF8A8A4CC4000CD5C500823E8240205A149C0E94B2C10A728F35F39C7D22DC135F96549380CC8F4FB1550D9380055DE52730D3A5805B82AF423BC3AA17CC2B5F81BE5E42EA7AC9B3242A586B9BA84203510705B6BA99AFD1628231CF5C5457440BEE3352A8C121BE32A02EB654D24F2F6E6C4DCB08FE9D88903290E3A41D816C0DDA5A7E5E4C461A2FF7C83EDB6722FC195764CD461D7F4D934ACE59A8BEA40D8E1074276F93C6F2E1892A91C656A9A3D315CF6635F3DD04425186F630E657C4987E28A3D1DFB4DE81F9AF8A0AAF29D6BFADF0ADEF033C43D088D7A07F4AE8FC81DF193830AF769B1C5F05502022FF9109E094F4F57687653FC07FCAD3F99F5F3B643E1E931DD050AB4D42DF26B1B0E36224DA037CC46BD982B7554DB2C3AFB18622B908D693ACEB5E4D7656644098BF844898C68B5ECC66ECB3CB68E13854942EF4BF14E8C50C6B9749956E5C28DF9F79BBCA894731CA08A763F516A0887EBAA3BC695083B43292BFD9D93EA437F27BA7A3B5856666309330264FB9CB46CD9B8A58DA65BEAFC7CEABDDEA11910C57826F350A7DB8931030B6DDBC765BEEBD9F0C2B7C45599BD451B7212660C2BB3332C4EE25BF5ADDFD41AF297EDC0AFFA04394B087F4C04545B2093C1A256374EF4E6C59FE71E977C838465D1FE995435D8C254C01A718C5FA9DA5890207EC377E33CAA965DA46256B3573D52D4A787E950BC401F25FDA6E801AEFBA46C389050E8C82EAB29E649DE84CB751D6FD2B4C678C9D41D12282DB66D01FA4E0B574E7E1E92B6D06E171397A9050777CE96795F10ED11B48036B8E0241FD38F05E9E353BEF1FD77F154C2A79245DB9EF3FAE43C1E7846ACFE57BFB0408B43C3682064A7BD8EB3B32EC99623BABB2C2F8FBA21E5D2DD5DDC1F05C4D3A3F7F897A0CA11F83FDA8DD0450002CAF580B993090B479D4B7CAADB9305A5F7B1C18287D1243FD408EA6FB677C9D66D381F67F3D6554BEAB422A44E6ED1A59D3C6411C1624AA33F7D2020674745B445817067B82626C4CE763BE68DCC2782534D5A77273A279E485E2234A2BE9392DBA66D59E80ED238310DDC6013A4D777EA5F208F4B8CE6573C68F808ED82BF753ACC63CD0C38985270B985A2676D2F38FB8F5648F885B8255B4023E22CAB64B57026D9B9ACC0A1D0D7B44ABF53454C584E51F2FCE56210386152F1BE1F00F2086D7ACE51D36E391E06F32B360C388D99459B9FE43772C305D7AA398EF67C0CAAC3CDCD0A55DABF39B50E5EA4F0BC06ECDDDA169EB58EFA0605495E549937F12A2A58691848E5CCAB4F7BB0B2A57F90F9988DE59A46CE4AC3197AE38704C4633CD29D2DBB23984DF4C5A958299F1F617B8F6999CA638A5881CBE56BDB3BD59A9642C8DAAE7597DD4CB9DCD54746E6DD4F410FE5319EA6F7DEB3BB4ABB2E24FBF730FD93324DB1304D4DFC7FE18A9195D05E894B872EAC00263EE324E22FDA500910753168F63FAF27B1FBFE6EE46FE5F336F34F90BBF4492001F4742CDDFACF7D964590BD52975C9E8DE67061B70CAF6D52D330DBE0C4B85C6B84A192AA74005BA63FDF3B698B70D81CD0F76BF9C9AA76B79ECADC154CBBBDA194B46A6E53E050E07BDE3F74C6BA1DA904A74A4674F48874471DBCABCD87A7AF9BD16ED64FB180F466E83B085A5961A424E158866A2B4D048FDA5F7CEB2C6A5CD58D2A6515B6B25F749C72999BEE9BAA4106ED001327DCDF3C8794DC1740BAED65EFDA2D73EC86CAA6F26547C7D77A568D2303FFB2DDB6DE267A1277E36C6313275F26E267A687D2380E4ED97493FBDA1AA4094AA53BF54566467A7A9169BE8221D02B3A0B1A6B939FEA50950EF6C0DDC9F47F018194C5610A88AE3EB5E3DCB8D887FA665B7B2632525840411DD7E5073694330AA159F178AF462111F1C7E04B6AE3A0B68F1C85A990B9231EA407A93624DF599ED10FA7D73CFE582331F74AC4B57BE6577A1F0EA43371FFD8A91DABCB17F6832328FAF6E04676E505AB4D6EA976B71E29FD4CBC0FA4AB9B942346FCF86DA877C58B811F8A9DE8FD32D31B36797B7C6691D0581C5E189AFEBD6029DB544B817DC4D6B2136187B45352618BB1436ECC9B396248BE14FDF77C730E648A3B046CB9AFD2AE27C9289DF692DD2D083189B5E8BD1F59FCF9016A7AD11C0DDEE7197E5F41A5F0DD2DABACA7964CDAA47AACB63E741C3F2E493F46D619DC1A0EDAB7005D5DC4729C32EB065388CD2D83FA5E0CABCDFBE4DDEB77D2FBA9B6C904642459F4BFFBFAD39418CE972E7567EB5BB8DEC5F7598CB0273E2E015A33DF2545B96013A5BA636730A91DFD011166EFC8007299765C1AEA08D777CA64ECE3F45EB1615D5F09D6F86F886B6076FCF7280B52666CC32B08871022C7CECEE684A6B60884A147215285E064878C4347935E92730F65BFAB7919083A63D6538FC477AD838531732A36378AEFB4FAA5550283CDEDAD7475EBEF7305C9B1FE48C40C6CA8DE52722BFDE4B631954192CA2C90C365F5993640ACADC4D5EBC8EE3593DEB1546B31C7198DB6D4BDB57353C0D48BCCCAAD06944EBC184E18190BEBC3E6EBB18CF00DC36F5C098BC70D806E63BC829819756887DD2261B5704AB55FB61D021BEC95198489DA28BC86DC29395113D16DFCC7F7AFF75D295519243CA98AC9F93FAB67523396CE3BC9133D5A077C975A739521F86998FCB4037F34E8380DE1D810A55D887F7FCA49FA6444CDD777D32573FE804312C3A55DB0C098983281B6C20278B63A57FECFFA8E4D3709FB0FF6049EC4035882482FD394BE0719ACD99B07AA68DAD6C887B6B329C421CB3D215F09AB5D63F30503C49F0722EC7DE48035C6415F71CFFE2FDD8470BD938D9CF83FF84586277F3A20527911670F214122AD78AE0E38A288450C71D035C09E9C77C278A24E47C319259BF112F091441A0A533B7A209F99C28E606FFC12AC6F08780F7811FE96FF656EE0FE902C6DDB23CB0E4466A7DB8DBFB26CF14874B7E0CD2AB815250E4CA30EE8AD6C30C8989BD39F60A55E6F80212E244B8A1C08AF507475156B28C240FA19B50E850F8BA20EC2169120081B319E27B0E46508C77315C43E72F573E3A3872F3313732C8D34BD00C5E8927419FCC8A8C6AC75B2A9BAE5B1662F88CAE66E544086FF0F776489634C9F1A6046F1A70D86211BA2E38F021BC86006DF363F92B4FD775F369C4502FF2B28B80C64E03A02E2CE8BF7ACA119666D2949E587E553962962CAA66513D69564D4D4A5B3E9A50CB7D5EB49C423076D67AB123FAD89C1892F629141A0E72D28BC953E0C7EADACA259879205BC4E22D077E05CF5DE353EC83216AF8D2DA758F2DCFD82AD83326EA7A58D5884A15E62A05A4835D8C5AEDFB8F45C5DBB7AD7F4E6E4A069BB8D8BBAA0F006FAEA2C89FAE85DB0E43A37AD08F6FB9950D6A14177B79F32CE9E74C156721D75E0D1A94BBA87CCCF2401E1F5721B93E0C1CA1D5F08DB42041C3BC89525910AB87BA8DB1880E12A7CEBCEDA6E49271C1B58D86692886BA7F37FEAD274866B2BB5ED5D47D243874D3AB54C9744B3D5014D9047763FE454B78BF2123B74FEB9320442E0832D290940885B493993A31D1CD63C8DF5167C45E7FC7486BFD0BE76FB7B29F47C80F46ED6385510F3D2FE7ECE434B102A1F76F27D578C1EB1CC9B6F19E123A23CA973065A2A9875FEBE17AE14C8BDCF0F0AA6297F4DF36DAD67FACE2AB80FB8F680A58676B59835F3C2C53BE9E027CF0387C8E3CE49D9354F2BA714FB838456C46CAF9B67CB230E68464D85BCD4EEEB30D2D5882F6590BDE742DE217146B9E05A10E95D6F334AB3BDCC1FDFCE9927A3183350692DEC9EA666E497C4A795263BCA250C7C0D2B1D9EDBAEE64F2C8293A0CD58A7266A635AD7D8F947B35FFFA9F3883348FF92B7376AA3A5EBDC7780D79BDEF1AFAEBC15E02E4FB838C097EC1E5DBCCF129C130F50C90FEF55BEE92DD4BF1CCC08A5E353A08FCB14DC6917908F75CF4748ACBFEE111974FBC3D1916A1572BDDBCB1C3565170F6540DF261312D13D7F5E6F62EDEF355B90965E27DA050621138F8CD98E4D74806F809B3CAE4EA67D918CB790A9C0567E3D4EC75232AEC99D603AC0287A7424B93A1E01A2AF9B472FD1E9B4CA4CFA6845A14F");
        assert!(v[0].smlen == 10301);
    }
}
