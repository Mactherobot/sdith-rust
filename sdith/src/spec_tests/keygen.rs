#[cfg(test)]
mod tests {
    use crate::{
        keygen::{keygen, PublicKey},
        spec_tests::SPEC_MASTER_SEED,
    };

    #[test]
    fn test_pk_compare_to_spec() {
        let spec_pk = [
            6u8, 168, 14, 105, 170, 134, 79, 217, 168, 237, 36, 80, 142, 124, 210, 149, 94, 199,
            184, 194, 151, 197, 189, 96, 35, 216, 242, 229, 32, 70, 37, 206, 221, 89, 225, 106,
            198, 103, 215, 143, 82, 37, 155, 22, 54, 229, 214, 230, 15, 233, 227, 235, 33, 16, 215,
            198, 7, 3, 84, 235, 27, 233, 160, 125, 110, 95, 94, 241, 244, 164, 24, 169, 46, 129, 1,
            107, 218, 123, 145, 58, 92, 7, 217, 37, 18, 209, 241, 12, 114, 238, 16, 75, 54, 209,
            169, 146, 113, 207, 2, 214, 67, 194, 100, 82, 237, 91, 124, 97, 18, 168, 157, 182, 146,
            99, 19, 187, 117, 91, 49, 220, 126, 85, 168, 254, 228, 135, 5, 67, 1, 137, 211, 237,
        ];

        let (pk, ..) = keygen(SPEC_MASTER_SEED);

        let spec_pk = PublicKey::parse(&spec_pk);

        assert_eq!(pk.seed_h, spec_pk.seed_h, "seed_h mismatch");
        assert_eq!(pk.y, spec_pk.y, "y mismatch");
    }
}
